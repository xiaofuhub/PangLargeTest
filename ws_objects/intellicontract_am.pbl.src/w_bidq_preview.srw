$PBExportHeader$w_bidq_preview.srw
forward
global type w_bidq_preview from window
end type
type ole_doc from u_email_edit within w_bidq_preview
end type
type uo_image_cp from uo_dm_image_view_cp within w_bidq_preview
end type
end forward

global type w_bidq_preview from window
integer width = 3003
integer height = 1688
boolean titlebar = true
string title = "View Document"
boolean controlmenu = true
boolean minbox = true
boolean maxbox = true
boolean resizable = true
long backcolor = 33551856
string icon = "AppIcon!"
boolean center = true
ole_doc ole_doc
uo_image_cp uo_image_cp
end type
global w_bidq_preview w_bidq_preview

type prototypes
FUNCTION long ShellExecute(long hwnd, string lpOperation, string lpFile, string lpParameters, string lpDirectory, long nShowCmd) LIBRARY "shell32.dll"  ALIAS FOR "ShellExecuteA;Ansi"
end prototypes

type variables
n_cst_dm_utils inv_utils
end variables

on w_bidq_preview.create
this.ole_doc=create ole_doc
this.uo_image_cp=create uo_image_cp
this.Control[]={this.ole_doc,&
this.uo_image_cp}
end on

on w_bidq_preview.destroy
destroy(this.ole_doc)
destroy(this.uo_image_cp)
end on

event open;string ls_Title
string ls_FileFullName
string ls_FileName
string ls_FileType
integer li_Pos

gnv_reg_ocx.of_check_ocx( 1,'', True) //1: office //Added by Ken.Guo on 2008-11-06

// Set title text
li_Pos = Pos(Message.StringParm, "|")
ls_Title = Left(Message.StringParm, li_Pos - 1)
this.Title = ls_Title

// Get file information
ls_FileFullName = Right(Message.StringParm, Len(Message.StringParm) - li_Pos)
ls_FileName = inv_utils.of_get_filename(ls_FileFullName)
ls_FileType = Lower(inv_utils.of_get_fileext(ls_FileFullName))

// Open file according to file type
ole_doc.Hide()
//uo_image.Hide()
uo_image_cp.Hide()
choose case Lower(ls_FileType)
	case "doc", "docx", "xls"
		try
			ole_doc.Show()
			ole_doc.object.Caption = ls_FileName
			ole_doc.object.OpenLocalFile(ls_FileFullName , true)
			//---------Begin Added by (Appeon)Harry 01.28.2014 for V142 ISG-CLX--------
			gnv_word_utility.of_modify_word_property( ole_doc.object.ActiveDocument)	//Added By Mark Lee 06/20/2013 change for office 2013.			
			//---------End Added ------------------------------------------------------
		catch (RunTimeError e)
			if IsValid(w_appeon_gifofwait) then Close(w_appeon_gifofwait)
			MessageBox('Error', 'The Office Viewer Active X Control has failed.')			
			Close(this)
			Return
		end try
	case "tif"
		if gi_imageocx = 1 then
			//Image 360 control was installed
			//uo_image.Show()
			//uo_image.of_open_localfile(ls_FileFullName)
			//uo_image.of_set_readonly(true)
		else
			uo_image_cp.Show()
			uo_image_cp.of_Initialize(ls_Title, "tif")
			uo_image_cp.of_open_localfile(ls_FileFullName)
			uo_image_cp.of_set_readonly(true)
		end if
	case else
		if IsValid(w_appeon_gifofwait) then Close(w_appeon_gifofwait)
		ShellExecute(0, "open", ls_FileFullName, "", "", 1)
		Close(this)
		Return
end choose

// Close progress if is open
if IsValid(w_appeon_gifofwait) then Close(w_appeon_gifofwait)
end event

event resize;ole_doc.Move(0, 0)
ole_doc.Resize(Width - 25, Height - 100)

//uo_image.Move(0, 0)
//uo_image.Resize(Width - 30, Height - 105)

uo_image_cp.Move(0, 0)
uo_image_cp.Resize(Width - 30, Height - 105)
end event

event close;ole_doc.object.Close()
end event

event activate;//Added By Ken.Guo 2011-11-30. Workaround Office OCX's bug
If isvalid(ole_doc ) Then
	ole_doc.object.activate(true)
End If
end event

type ole_doc from u_email_edit within w_bidq_preview
integer width = 2949
integer height = 792
integer taborder = 110
borderstyle borderstyle = stylebox!
string binarykey = "w_bidq_preview.win"
end type

type uo_image_cp from uo_dm_image_view_cp within w_bidq_preview
integer x = 398
integer y = 804
integer taborder = 100
end type

on uo_image_cp.destroy
call uo_dm_image_view_cp::destroy
end on


Start of PowerBuilder Binary Data Section : Do NOT Edit
0Ew_bidq_preview.bin 
2100000e00e011cfd0e11ab1a1000000000000000000000000000000000003003e0009fffe000000060000000000000000000000010000000100000000000010000000000200000001fffffffe0000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdfffffffefffffffe0000000400000005fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff006f00520074006f004500200074006e00790072000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050016ffffffffffffffff00000001000000000000000000000000000000000000000000000000000000008a9f333001d1313200000003000005000000000000500003004f0042005800430054005300450052004d0041000000000000000000000000000000000000000000000000000000000000000000000000000000000102001affffffff00000002ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000025400000000004200500043004f00530058004f00540041005200450047000000000000000000000000000000000000000000000000000000000000000000000000000000000001001affffffffffffffff00000003c9bc4e0f4a3c4248a763498a04f417d3000000008a9f333001d131328a9f333001d131320000000000000000000000000054004e004f004b0066004f0069006600650063007400430053006c006d0074000000000000000000000000000000000000000000000000000000000000000001020022ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000a0000025400000000000000010000000200000003000000040000000500000006000000070000000800000009fffffffe0000000b0000000c0000000d0000000e0000000f00000010000000110000001200000013fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
20ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1234abcd000042aa0000147700dbc29d800000058000000800ffffff00000000010100010000000000000022006e004900650074006c006c005300690066006f00200074007200470075006f005000700037000000300031004500370043003800330037003200330045004500410045004100450036004200320033003800380038004100330041003700330032003300450041004200430041003100380046000000350000000000220000004900000074006e006c00650069006c006f00530074006600470020006f00720070007500000050003400430043003500300041004200370035004300380030003700350046004200360041003800360036003100460031004500360037003300350045003000300044003500340031003700440030003600000001000000000000000000000001000000010000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff000000000000000100dbc29d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700f6e6d300e3ba9200000003000000000000000000000000000000000000000100000000000004e400000001000000010000000100000000000000b4000000b4000000010000000000000000000000000000000000000000000000010000000000000000000000010000000000800000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001234abcd000042aa0000147700dbc29d800000058000000800ffffff00000000010100010000000000000022006e004900650074006c006c005300690066006f00200074007200470075006f005000700037000000300031004500370043003800330037003200330045004500410045004100450036004200320033003800380038004100330041003700330032003300450041004200430041003100380046000000350000000000220000004900000074006e006c00650069006c006f00530074006600470020006f00720070007500000050003400430043003500300041004200370035004300380030003700350046004200360041003800360036003100460031004500360037003300350045003000300044003500340031003700440030003600000001000000000000000000000001000000010000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff0000ffff000000000000000100dbc29d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700f6e6d300e3ba9200000003000000000000000000000000000000000000000100000000000004e400000001000000010000000100000000000000b4000000b400000001000000000000000000000000000000000000000000000001000000000000000000000001000000000080000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1Ew_bidq_preview.bin 
End of PowerBuilder Binary Data Section : No Source Expected After This Point
