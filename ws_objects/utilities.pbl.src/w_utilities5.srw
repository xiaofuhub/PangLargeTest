$PBExportHeader$w_utilities5.srw
forward
global type w_utilities5 from window
end type
type cb_usertracking from commandbutton within w_utilities5
end type
type cb_report_log from commandbutton within w_utilities5
end type
type cb_sign from commandbutton within w_utilities5
end type
type cb_report_man from commandbutton within w_utilities5
end type
type cb_caqh_rost_set from commandbutton within w_utilities5
end type
type cb_8 from commandbutton within w_utilities5
end type
type cb_caqh_roster from commandbutton within w_utilities5
end type
type cb_copy_emailmsg from commandbutton within w_utilities5
end type
type cb_sync_alias from commandbutton within w_utilities5
end type
type cb_psv from commandbutton within w_utilities5
end type
type cb_userdocs from commandbutton within w_utilities5
end type
type cb_sessions from commandbutton within w_utilities5
end type
type cb_6 from commandbutton within w_utilities5
end type
type cb_namsspass_query from commandbutton within w_utilities5
end type
type cb_recruit_eva from commandbutton within w_utilities5
end type
type cb_recdata_entry from commandbutton within w_utilities5
end type
type cb_ctx_utilities from commandbutton within w_utilities5
end type
type cb_splash_set from commandbutton within w_utilities5
end type
type cb_namsspass_upload from commandbutton within w_utilities5
end type
type cb_gud from commandbutton within w_utilities5
end type
type cb_batch_add from commandbutton within w_utilities5
end type
type cb_app_track_utl from commandbutton within w_utilities5
end type
type cb_npdb_reload from commandbutton within w_utilities5
end type
type cb_lookup_cleanup from commandbutton within w_utilities5
end type
type cb_email_sent_items from commandbutton within w_utilities5
end type
type cb_images from commandbutton within w_utilities5
end type
type cb_5 from commandbutton within w_utilities5
end type
type cb_group_painter from commandbutton within w_utilities5
end type
type cb_app_tracking_setup from commandbutton within w_utilities5
end type
type cb_standing from commandbutton within w_utilities5
end type
type cb_reg from commandbutton within w_utilities5
end type
type cb_alert_audit from commandbutton within w_utilities5
end type
type cb_caqh_settings from commandbutton within w_utilities5
end type
type cb_overview from commandbutton within w_utilities5
end type
type cb_hvc from commandbutton within w_utilities5
end type
type cb_aquest_sync from commandbutton within w_utilities5
end type
type cb_importphoto from commandbutton within w_utilities5
end type
type cb_set_facility_app_label from commandbutton within w_utilities5
end type
type cb_fixfax from commandbutton within w_utilities5
end type
type cb_npdb from commandbutton within w_utilities5
end type
type cb_view_alias from commandbutton within w_utilities5
end type
type cb_migrate from commandbutton within w_utilities5
end type
type cb_updae_sql from commandbutton within w_utilities5
end type
type cb_wc_setup from commandbutton within w_utilities5
end type
type cb_crawls from commandbutton within w_utilities5
end type
type cb_dba from commandbutton within w_utilities5
end type
type cb_sec_paint from commandbutton within w_utilities5
end type
type cb_nonprac from commandbutton within w_utilities5
end type
type cb_caqh_codes from commandbutton within w_utilities5
end type
type cb_caqh_fields from commandbutton within w_utilities5
end type
type cb_screen_view from commandbutton within w_utilities5
end type
type cb_paths from commandbutton within w_utilities5
end type
type cb_4 from commandbutton within w_utilities5
end type
type cb_index from commandbutton within w_utilities5
end type
type cb_date_fields from commandbutton within w_utilities5
end type
type cb_appt_painter from commandbutton within w_utilities5
end type
type cb_clear_quotes from commandbutton within w_utilities5
end type
type cb_prem_utl from commandbutton within w_utilities5
end type
type cb_selects from commandbutton within w_utilities5
end type
type cb_check_ids from commandbutton within w_utilities5
end type
type cb_exp_not_comp from commandbutton within w_utilities5
end type
type cb_registry from commandbutton within w_utilities5
end type
type cb_user_reset from commandbutton within w_utilities5
end type
type cb_bd_exp from commandbutton within w_utilities5
end type
type cb_comp_info from commandbutton within w_utilities5
end type
type cb_requested from commandbutton within w_utilities5
end type
type cb_field_ord_chk from commandbutton within w_utilities5
end type
type cb_iapp_fix from commandbutton within w_utilities5
end type
type cb_multi_affil_check from commandbutton within w_utilities5
end type
type cb_dapplications from commandbutton within w_utilities5
end type
type cb_dmanual from commandbutton within w_utilities5
end type
type cb_print_reset from commandbutton within w_utilities5
end type
type cb_assignedusers from commandbutton within w_utilities5
end type
type cb_oig from commandbutton within w_utilities5
end type
type st_2 from statictext within w_utilities5
end type
type cb_user_security from commandbutton within w_utilities5
end type
type cb_docids from commandbutton within w_utilities5
end type
type cb_stat_check from commandbutton within w_utilities5
end type
type cb_support_settings from commandbutton within w_utilities5
end type
type cb_priv_adj from commandbutton within w_utilities5
end type
type cb_comm_review_fix from commandbutton within w_utilities5
end type
type cb_links from commandbutton within w_utilities5
end type
type cb_db_back from commandbutton within w_utilities5
end type
type cb_fix from commandbutton within w_utilities5
end type
type dw_3 from datawindow within w_utilities5
end type
type cb_3 from commandbutton within w_utilities5
end type
type cb_2 from commandbutton within w_utilities5
end type
type cb_1 from commandbutton within w_utilities5
end type
type dw_facilcomm from datawindow within w_utilities5
end type
type dw_praccomm from datawindow within w_utilities5
end type
type dw_pracaffil from datawindow within w_utilities5
end type
type gb_adm from groupbox within w_utilities5
end type
type gb_2 from groupbox within w_utilities5
end type
type dw_dvfieldcopy from datawindow within w_utilities5
end type
type dw_data_view_list from datawindow within w_utilities5
end type
type gb_3 from groupbox within w_utilities5
end type
type gb_4 from groupbox within w_utilities5
end type
type cb_settings from commandbutton within w_utilities5
end type
type cb_mod_prf_scr from commandbutton within w_utilities5
end type
type cb_clientsetting from commandbutton within w_utilities5
end type
type cb_old from commandbutton within w_utilities5
end type
type cb_image_migrate from commandbutton within w_utilities5
end type
type gb_hide from groupbox within w_utilities5
end type
end forward

global type w_utilities5 from window
integer x = 59
integer y = 48
integer width = 3022
integer height = 2596
boolean titlebar = true
string title = "IntelliCred/App Utilities"
boolean controlmenu = true
boolean minbox = true
long backcolor = 33551856
boolean center = true
cb_usertracking cb_usertracking
cb_report_log cb_report_log
cb_sign cb_sign
cb_report_man cb_report_man
cb_caqh_rost_set cb_caqh_rost_set
cb_8 cb_8
cb_caqh_roster cb_caqh_roster
cb_copy_emailmsg cb_copy_emailmsg
cb_sync_alias cb_sync_alias
cb_psv cb_psv
cb_userdocs cb_userdocs
cb_sessions cb_sessions
cb_6 cb_6
cb_namsspass_query cb_namsspass_query
cb_recruit_eva cb_recruit_eva
cb_recdata_entry cb_recdata_entry
cb_ctx_utilities cb_ctx_utilities
cb_splash_set cb_splash_set
cb_namsspass_upload cb_namsspass_upload
cb_gud cb_gud
cb_batch_add cb_batch_add
cb_app_track_utl cb_app_track_utl
cb_npdb_reload cb_npdb_reload
cb_lookup_cleanup cb_lookup_cleanup
cb_email_sent_items cb_email_sent_items
cb_images cb_images
cb_5 cb_5
cb_group_painter cb_group_painter
cb_app_tracking_setup cb_app_tracking_setup
cb_standing cb_standing
cb_reg cb_reg
cb_alert_audit cb_alert_audit
cb_caqh_settings cb_caqh_settings
cb_overview cb_overview
cb_hvc cb_hvc
cb_aquest_sync cb_aquest_sync
cb_importphoto cb_importphoto
cb_set_facility_app_label cb_set_facility_app_label
cb_fixfax cb_fixfax
cb_npdb cb_npdb
cb_view_alias cb_view_alias
cb_migrate cb_migrate
cb_updae_sql cb_updae_sql
cb_wc_setup cb_wc_setup
cb_crawls cb_crawls
cb_dba cb_dba
cb_sec_paint cb_sec_paint
cb_nonprac cb_nonprac
cb_caqh_codes cb_caqh_codes
cb_caqh_fields cb_caqh_fields
cb_screen_view cb_screen_view
cb_paths cb_paths
cb_4 cb_4
cb_index cb_index
cb_date_fields cb_date_fields
cb_appt_painter cb_appt_painter
cb_clear_quotes cb_clear_quotes
cb_prem_utl cb_prem_utl
cb_selects cb_selects
cb_check_ids cb_check_ids
cb_exp_not_comp cb_exp_not_comp
cb_registry cb_registry
cb_user_reset cb_user_reset
cb_bd_exp cb_bd_exp
cb_comp_info cb_comp_info
cb_requested cb_requested
cb_field_ord_chk cb_field_ord_chk
cb_iapp_fix cb_iapp_fix
cb_multi_affil_check cb_multi_affil_check
cb_dapplications cb_dapplications
cb_dmanual cb_dmanual
cb_print_reset cb_print_reset
cb_assignedusers cb_assignedusers
cb_oig cb_oig
st_2 st_2
cb_user_security cb_user_security
cb_docids cb_docids
cb_stat_check cb_stat_check
cb_support_settings cb_support_settings
cb_priv_adj cb_priv_adj
cb_comm_review_fix cb_comm_review_fix
cb_links cb_links
cb_db_back cb_db_back
cb_fix cb_fix
dw_3 dw_3
cb_3 cb_3
cb_2 cb_2
cb_1 cb_1
dw_facilcomm dw_facilcomm
dw_praccomm dw_praccomm
dw_pracaffil dw_pracaffil
gb_adm gb_adm
gb_2 gb_2
dw_dvfieldcopy dw_dvfieldcopy
dw_data_view_list dw_data_view_list
gb_3 gb_3
gb_4 gb_4
cb_settings cb_settings
cb_mod_prf_scr cb_mod_prf_scr
cb_clientsetting cb_clientsetting
cb_old cb_old
cb_image_migrate cb_image_migrate
gb_hide gb_hide
end type
global w_utilities5 w_utilities5

type variables
KeyCode ik_keycode
end variables

forward prototypes
public function integer of_password (string ai_window)
public function integer of_readonly ()
end prototypes

public function integer of_password (string ai_window);//string ls_pass
//
////ls_pass = string(ai_window)
////messagebox("window",ls_pass)
//
//ls_pass = sle_pass.text
//
//if len(ls_pass) < 1 then
//	messagebox("Enter Password","You need to enter the correct support password to use this utility.")
//	return -1
//end if
//
//if ai_window = "w_sql_send" then
//	if upper(ls_pass) <> "INTELLISQL" then
//		messagebox("Incorrect Password","You must enter the correct support password for the SQL utility.")
//		return -1
//	end if
//elseif upper(ls_pass) <> "INTELLISET" then
//	messagebox("Incorrect Password","You must enter the correct support password to use this utility.")
//	return -1
//end if
//
return 1
end function

public function integer of_readonly ();
//Start Code Change ----08.11.2014 #V14.2 maha - function added
	cb_dmanual.enabled = false
	cb_dapplications.enabled = false
	cb_crawls.enabled = false
	cb_priv_adj.enabled = false
	cb_multi_affil_check.enabled = false
	cb_aquest_sync.enabled = false
	cb_field_ord_chk.enabled = false
	cb_dba.enabled = false
	cb_exp_not_comp.enabled = false
	cb_fixfax.enabled = false
	cb_iapp_fix.enabled = false
	cb_links.enabled = false
	cb_docids.enabled = false
	cb_stat_check.enabled = false
	cb_overview.enabled = false
	cb_paths.enabled = false
	cb_user_security.enabled = false
	cb_hvc.enabled = false
	cb_fix.enabled = false
	cb_requested.enabled = false
	cb_bd_exp.enabled = false
	cb_caqh_fields.enabled = false
	cb_prem_utl.enabled = false
	cb_date_fields.enabled = false
	cb_index.enabled = false
	cb_alert_audit.enabled = false
	cb_db_back.enabled = false
	cb_4.enabled = false
	cb_print_reset.enabled = false
	cb_assignedusers.enabled = false
	cb_check_ids.enabled = false
	cb_5.enabled = false
	cb_clear_quotes.enabled = false
	cb_comm_review_fix.enabled = false
	cb_comp_info.enabled = false
	cb_importphoto.enabled = false
	cb_npdb.enabled = false
	cb_npdb_reload.enabled = false
	cb_updae_sql.enabled = false
	cb_view_alias.enabled = false
	cb_caqh_codes.enabled = false
	cb_oig.enabled = false
	cb_2.enabled = false
	cb_copy_emailmsg.enabled = false
	cb_caqh_roster.enabled = false//Added by Appeon long.zhang 05.14.2015 (v15.1 CAQH Roster Automation)
	

	
//	.enabled = false
//	.enabled = false
return 1
end function

on w_utilities5.create
this.cb_usertracking=create cb_usertracking
this.cb_report_log=create cb_report_log
this.cb_sign=create cb_sign
this.cb_report_man=create cb_report_man
this.cb_caqh_rost_set=create cb_caqh_rost_set
this.cb_8=create cb_8
this.cb_caqh_roster=create cb_caqh_roster
this.cb_copy_emailmsg=create cb_copy_emailmsg
this.cb_sync_alias=create cb_sync_alias
this.cb_psv=create cb_psv
this.cb_userdocs=create cb_userdocs
this.cb_sessions=create cb_sessions
this.cb_6=create cb_6
this.cb_namsspass_query=create cb_namsspass_query
this.cb_recruit_eva=create cb_recruit_eva
this.cb_recdata_entry=create cb_recdata_entry
this.cb_ctx_utilities=create cb_ctx_utilities
this.cb_splash_set=create cb_splash_set
this.cb_namsspass_upload=create cb_namsspass_upload
this.cb_gud=create cb_gud
this.cb_batch_add=create cb_batch_add
this.cb_app_track_utl=create cb_app_track_utl
this.cb_npdb_reload=create cb_npdb_reload
this.cb_lookup_cleanup=create cb_lookup_cleanup
this.cb_email_sent_items=create cb_email_sent_items
this.cb_images=create cb_images
this.cb_5=create cb_5
this.cb_group_painter=create cb_group_painter
this.cb_app_tracking_setup=create cb_app_tracking_setup
this.cb_standing=create cb_standing
this.cb_reg=create cb_reg
this.cb_alert_audit=create cb_alert_audit
this.cb_caqh_settings=create cb_caqh_settings
this.cb_overview=create cb_overview
this.cb_hvc=create cb_hvc
this.cb_aquest_sync=create cb_aquest_sync
this.cb_importphoto=create cb_importphoto
this.cb_set_facility_app_label=create cb_set_facility_app_label
this.cb_fixfax=create cb_fixfax
this.cb_npdb=create cb_npdb
this.cb_view_alias=create cb_view_alias
this.cb_migrate=create cb_migrate
this.cb_updae_sql=create cb_updae_sql
this.cb_wc_setup=create cb_wc_setup
this.cb_crawls=create cb_crawls
this.cb_dba=create cb_dba
this.cb_sec_paint=create cb_sec_paint
this.cb_nonprac=create cb_nonprac
this.cb_caqh_codes=create cb_caqh_codes
this.cb_caqh_fields=create cb_caqh_fields
this.cb_screen_view=create cb_screen_view
this.cb_paths=create cb_paths
this.cb_4=create cb_4
this.cb_index=create cb_index
this.cb_date_fields=create cb_date_fields
this.cb_appt_painter=create cb_appt_painter
this.cb_clear_quotes=create cb_clear_quotes
this.cb_prem_utl=create cb_prem_utl
this.cb_selects=create cb_selects
this.cb_check_ids=create cb_check_ids
this.cb_exp_not_comp=create cb_exp_not_comp
this.cb_registry=create cb_registry
this.cb_user_reset=create cb_user_reset
this.cb_bd_exp=create cb_bd_exp
this.cb_comp_info=create cb_comp_info
this.cb_requested=create cb_requested
this.cb_field_ord_chk=create cb_field_ord_chk
this.cb_iapp_fix=create cb_iapp_fix
this.cb_multi_affil_check=create cb_multi_affil_check
this.cb_dapplications=create cb_dapplications
this.cb_dmanual=create cb_dmanual
this.cb_print_reset=create cb_print_reset
this.cb_assignedusers=create cb_assignedusers
this.cb_oig=create cb_oig
this.st_2=create st_2
this.cb_user_security=create cb_user_security
this.cb_docids=create cb_docids
this.cb_stat_check=create cb_stat_check
this.cb_support_settings=create cb_support_settings
this.cb_priv_adj=create cb_priv_adj
this.cb_comm_review_fix=create cb_comm_review_fix
this.cb_links=create cb_links
this.cb_db_back=create cb_db_back
this.cb_fix=create cb_fix
this.dw_3=create dw_3
this.cb_3=create cb_3
this.cb_2=create cb_2
this.cb_1=create cb_1
this.dw_facilcomm=create dw_facilcomm
this.dw_praccomm=create dw_praccomm
this.dw_pracaffil=create dw_pracaffil
this.gb_adm=create gb_adm
this.gb_2=create gb_2
this.dw_dvfieldcopy=create dw_dvfieldcopy
this.dw_data_view_list=create dw_data_view_list
this.gb_3=create gb_3
this.gb_4=create gb_4
this.cb_settings=create cb_settings
this.cb_mod_prf_scr=create cb_mod_prf_scr
this.cb_clientsetting=create cb_clientsetting
this.cb_old=create cb_old
this.cb_image_migrate=create cb_image_migrate
this.gb_hide=create gb_hide
this.Control[]={this.cb_usertracking,&
this.cb_report_log,&
this.cb_sign,&
this.cb_report_man,&
this.cb_caqh_rost_set,&
this.cb_8,&
this.cb_caqh_roster,&
this.cb_copy_emailmsg,&
this.cb_sync_alias,&
this.cb_psv,&
this.cb_userdocs,&
this.cb_sessions,&
this.cb_6,&
this.cb_namsspass_query,&
this.cb_recruit_eva,&
this.cb_recdata_entry,&
this.cb_ctx_utilities,&
this.cb_splash_set,&
this.cb_namsspass_upload,&
this.cb_gud,&
this.cb_batch_add,&
this.cb_app_track_utl,&
this.cb_npdb_reload,&
this.cb_lookup_cleanup,&
this.cb_email_sent_items,&
this.cb_images,&
this.cb_5,&
this.cb_group_painter,&
this.cb_app_tracking_setup,&
this.cb_standing,&
this.cb_reg,&
this.cb_alert_audit,&
this.cb_caqh_settings,&
this.cb_overview,&
this.cb_hvc,&
this.cb_aquest_sync,&
this.cb_importphoto,&
this.cb_set_facility_app_label,&
this.cb_fixfax,&
this.cb_npdb,&
this.cb_view_alias,&
this.cb_migrate,&
this.cb_updae_sql,&
this.cb_wc_setup,&
this.cb_crawls,&
this.cb_dba,&
this.cb_sec_paint,&
this.cb_nonprac,&
this.cb_caqh_codes,&
this.cb_caqh_fields,&
this.cb_screen_view,&
this.cb_paths,&
this.cb_4,&
this.cb_index,&
this.cb_date_fields,&
this.cb_appt_painter,&
this.cb_clear_quotes,&
this.cb_prem_utl,&
this.cb_selects,&
this.cb_check_ids,&
this.cb_exp_not_comp,&
this.cb_registry,&
this.cb_user_reset,&
this.cb_bd_exp,&
this.cb_comp_info,&
this.cb_requested,&
this.cb_field_ord_chk,&
this.cb_iapp_fix,&
this.cb_multi_affil_check,&
this.cb_dapplications,&
this.cb_dmanual,&
this.cb_print_reset,&
this.cb_assignedusers,&
this.cb_oig,&
this.st_2,&
this.cb_user_security,&
this.cb_docids,&
this.cb_stat_check,&
this.cb_support_settings,&
this.cb_priv_adj,&
this.cb_comm_review_fix,&
this.cb_links,&
this.cb_db_back,&
this.cb_fix,&
this.dw_3,&
this.cb_3,&
this.cb_2,&
this.cb_1,&
this.dw_facilcomm,&
this.dw_praccomm,&
this.dw_pracaffil,&
this.gb_adm,&
this.gb_2,&
this.dw_dvfieldcopy,&
this.dw_data_view_list,&
this.gb_3,&
this.gb_4,&
this.cb_settings,&
this.cb_mod_prf_scr,&
this.cb_clientsetting,&
this.cb_old,&
this.cb_image_migrate,&
this.gb_hide}
end on

on w_utilities5.destroy
destroy(this.cb_usertracking)
destroy(this.cb_report_log)
destroy(this.cb_sign)
destroy(this.cb_report_man)
destroy(this.cb_caqh_rost_set)
destroy(this.cb_8)
destroy(this.cb_caqh_roster)
destroy(this.cb_copy_emailmsg)
destroy(this.cb_sync_alias)
destroy(this.cb_psv)
destroy(this.cb_userdocs)
destroy(this.cb_sessions)
destroy(this.cb_6)
destroy(this.cb_namsspass_query)
destroy(this.cb_recruit_eva)
destroy(this.cb_recdata_entry)
destroy(this.cb_ctx_utilities)
destroy(this.cb_splash_set)
destroy(this.cb_namsspass_upload)
destroy(this.cb_gud)
destroy(this.cb_batch_add)
destroy(this.cb_app_track_utl)
destroy(this.cb_npdb_reload)
destroy(this.cb_lookup_cleanup)
destroy(this.cb_email_sent_items)
destroy(this.cb_images)
destroy(this.cb_5)
destroy(this.cb_group_painter)
destroy(this.cb_app_tracking_setup)
destroy(this.cb_standing)
destroy(this.cb_reg)
destroy(this.cb_alert_audit)
destroy(this.cb_caqh_settings)
destroy(this.cb_overview)
destroy(this.cb_hvc)
destroy(this.cb_aquest_sync)
destroy(this.cb_importphoto)
destroy(this.cb_set_facility_app_label)
destroy(this.cb_fixfax)
destroy(this.cb_npdb)
destroy(this.cb_view_alias)
destroy(this.cb_migrate)
destroy(this.cb_updae_sql)
destroy(this.cb_wc_setup)
destroy(this.cb_crawls)
destroy(this.cb_dba)
destroy(this.cb_sec_paint)
destroy(this.cb_nonprac)
destroy(this.cb_caqh_codes)
destroy(this.cb_caqh_fields)
destroy(this.cb_screen_view)
destroy(this.cb_paths)
destroy(this.cb_4)
destroy(this.cb_index)
destroy(this.cb_date_fields)
destroy(this.cb_appt_painter)
destroy(this.cb_clear_quotes)
destroy(this.cb_prem_utl)
destroy(this.cb_selects)
destroy(this.cb_check_ids)
destroy(this.cb_exp_not_comp)
destroy(this.cb_registry)
destroy(this.cb_user_reset)
destroy(this.cb_bd_exp)
destroy(this.cb_comp_info)
destroy(this.cb_requested)
destroy(this.cb_field_ord_chk)
destroy(this.cb_iapp_fix)
destroy(this.cb_multi_affil_check)
destroy(this.cb_dapplications)
destroy(this.cb_dmanual)
destroy(this.cb_print_reset)
destroy(this.cb_assignedusers)
destroy(this.cb_oig)
destroy(this.st_2)
destroy(this.cb_user_security)
destroy(this.cb_docids)
destroy(this.cb_stat_check)
destroy(this.cb_support_settings)
destroy(this.cb_priv_adj)
destroy(this.cb_comm_review_fix)
destroy(this.cb_links)
destroy(this.cb_db_back)
destroy(this.cb_fix)
destroy(this.dw_3)
destroy(this.cb_3)
destroy(this.cb_2)
destroy(this.cb_1)
destroy(this.dw_facilcomm)
destroy(this.dw_praccomm)
destroy(this.dw_pracaffil)
destroy(this.gb_adm)
destroy(this.gb_2)
destroy(this.dw_dvfieldcopy)
destroy(this.dw_data_view_list)
destroy(this.gb_3)
destroy(this.gb_4)
destroy(this.cb_settings)
destroy(this.cb_mod_prf_scr)
destroy(this.cb_clientsetting)
destroy(this.cb_old)
destroy(this.cb_image_migrate)
destroy(this.gb_hide)
end on

event open;
this.backcolor = gl_bg_color2
gw_popup[UpperBound(gw_popup[]) + 1] = This //Added by Appeon long.zhang 11.06.2015 (V14.2 Applause Bug # 4830 - The Home and Utilities windows do not close when you relogin (login as..))

if w_mdi.of_security_access( 1345 ) = 0   then 
	cb_selects.enabled = false
	cb_caqh_settings.enabled = false  //Start Code Change ----04.19.2011 #V11 maha 
	cb_reg.enabled = false   //Start Code Change ----04.19.2011 #V11 maha 
	cb_screen_view.enabled = false
	cb_user_reset.enabled = false	
	cb_app_tracking_setup.enabled =  false  	//Start Code Change ----07.21.2010 #V10 maha
	cb_appt_painter.enabled = false   //Start Code Change ----04.19.2011 #V11 maha 
	cb_group_painter.enabled = false   //Start Code Change ----04.19.2011 #V11 maha 
	cb_set_facility_app_label.enabled = false   //Start Code Change ----04.19.2011 #V11 maha 
	cb_nonprac.enabled = false
	cb_sec_paint.enabled = false
	cb_standing.enabled = false 	//Start Code Change ----03.03.2010 #V10 maha
	cb_registry.enabled = false
	cb_wc_setup.enabled = false
	cb_migrate.enabled = false
	cb_app_track_utl.enabled = false
	cb_images.enabled = false
	cb_lookup_cleanup.enabled = false  //Start Code Change ----08.07.2012 #V12 maha
	cb_email_sent_items.enabled = false  //Start Code Change ---10.08.2012 #V12 maha
	cb_batch_add.enabled = false  //Start Code Change ---12.11.2012 #V12 maha
	cb_psv.enabled = false  //Start Code Change ---02.05.2013 #V12 maha
	cb_sessions.enabled = false  //Start Code Change ----10.29.2013 #V14 maha
	cb_gud.enabled = false  //Start Code Change ----01.03.2014 #V14 maha
	cb_sync_alias.enabled = false  //Start Code Change ---01.22.2014 #V14 maha
	cb_copy_emailmsg.enabled = false //(Appeon)Stephen 06.03.2014 - copy email messages
	cb_caqh_rost_set.enabled = false  //Start Code Change ----01.06.2016 #V15 maha
//	cb_settings.enabled = false	//moved down
	cb_report_man.enabled = false  //Start Code Change ----01.07.2016 #V15 maha
	cb_sign.enabled = false   //Start Code Change ----07.27.2016 #V152 maha
	cb_usertracking.enabled = false	 //Start Code Change ----01.26.2017 #V153 maha - added
	cb_userdocs.enabled = false		 //Start Code Change ----01.26.2017 #V153 maha - added
end if



if w_mdi.of_security_access( 1380 ) = 0   then   //Start Code Change ----04.19.2011 #V11 maha - moved from above
	cb_settings.enabled = false
else
	cb_settings.weight = 800   //Start Code Change ----03.15.2016 #V15 maha - make bold
end if

//Start Code Change ----08.11.2014 #V14.2 maha
if w_mdi.of_security_access( 7765 ) = 0   then   
	cb_user_reset.enabled = false
else
	cb_user_reset.weight = 800  //Start Code Change ----03.15.2016 #V15 maha - make bold
end if

//readonly
IF w_mdi.of_security_access( 1340 ) = 1 THEN
	of_readonly( )
end if
//End Code Change ----08.11.2014

//------------------- APPEON BEGIN -------------------
//$<add> Stephen 11.09.2012
//$<reason> reload  XML file content into report tables
if of_get_app_setting("set_8","I")  <> 2 then
	cb_npdb_reload.visible = false
end if
//------------------- APPEON END -------------------

if gi_iapp_on = 0  then
	cb_dapplications.enabled = false
end if

//Start Code Change ---- 10.03.2006 #651 maha
if of_get_app_setting("set_19", "I") = 1 then
	cb_prem_utl.visible = true
	gb_hide.bringtotop = true
	cb_old.bringtotop = true
end if
//End Code Change---10.03.2006

//v12.1 web component - alfee 04.21.2012
IF appeongetclienttype() = "WEB" and Not gb_AutoDwnReg Then
	//cb_reg.enabled = false //(V12.3 Cab) commented by alfee 02.28.2013
END IF

if gs_dbtype = "SQL" then
	cb_db_back.visible  = false
end if

//---------Begin Modified by (Appeon)Harry 07.10.2013 for V141 ISG-CLX--------
If gnv_data.of_getitem("icred_settings", "set_cont", false) = "1" then
	cb_ctx_utilities.visible = true
Else
	cb_ctx_utilities.visible = false
End if
//---------End Modfiied ------------------------------------------------------

 //Start Code Change ----11.10.2015 #V15 maha
IF w_mdi.of_security_access( 7806 ) = 0 THEN
	cb_caqh_roster.visible = false
end if

 //Start Code Change ----01.06.2016 #V15 maha
IF w_mdi.of_security_access( 7807 ) = 0 THEN
	cb_caqh_rost_set.visible = false
end if

IF w_mdi.of_security_access( 7817 ) = 0 THEN
	cb_report_man.visible = false
end if

// (Appeon)Harry 05.26.2016 - Application Electronic Signature - Sertifi
//IF gnv_data.of_getitem( 'icred_settings', 'esign', False) ='1' and gs_esigntype = 'sertifi' THEN
IF gnv_data.of_getitem( 'icred_settings', 'esign', False) ='1' and gs_esigntype <> ' echosign' THEN // (Appeon)Harry 07.08.2016 - for docusign
	cb_sign.visible = True
ELSE
	cb_sign.visible = False
END IF

end event

event key;// R.Avital 11.3 BugM082101
// Begin changes
IF key = KeyEscape! THEN
	ik_keycode = key
END IF
// End changes
end event

type cb_usertracking from commandbutton within w_utilities5
integer x = 69
integer y = 1984
integer width = 896
integer height = 92
integer taborder = 450
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "User Tracking"
end type

event clicked;// (Appeon)Harry 06.13.2013 - V141 ISG-CLX
open(w_user_tracking)
end event

type cb_report_log from commandbutton within w_utilities5
integer x = 2030
integer y = 2288
integer width = 919
integer height = 92
integer taborder = 340
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Report Run Log"
end type

event clicked;open(w_report_log)
end event

type cb_sign from commandbutton within w_utilities5
integer x = 69
integer y = 636
integer width = 896
integer height = 92
integer taborder = 370
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Electronic Signature Settings"
end type

event clicked;// (Appeon)Harry 05.26.2016 - Application Electronic Signature - Sertifi
//Open(w_esign_settings)

if gs_esigntype = 'docusign' then  // (Appeon)Harry 07.08.2016 - for docusign
	Open(w_esign_settings_docusign)
Else
	Open(w_esign_settings)
End if

end event

type cb_report_man from commandbutton within w_utilities5
integer x = 69
integer y = 1024
integer width = 896
integer height = 92
integer taborder = 590
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "IntelliReports Management"
end type

event clicked;//open(w_validation_setup)
//open(w_sys_field_import)
//open(w_setup_central)
open(w_custom_report_manage)
//open(w_mockup_1)
//openwithparm(w_exp_cred_create_util, "Utility")
//open(w_setup_window)
//open(w_wv_tracking_report)
//open(w_appl_track_utl )
//open(w_batch_add_oppe)

end event

type cb_caqh_rost_set from commandbutton within w_utilities5
integer x = 69
integer y = 544
integer width = 896
integer height = 92
integer taborder = 410
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "CAQH Roster Settings"
end type

event clicked;
open(w_caqh_roster_setup)
end event

type cb_8 from commandbutton within w_utilities5
integer x = 2030
integer y = 1616
integer width = 919
integer height = 92
integer taborder = 450
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Imacros Path Test"
end type

event clicked;nvo_web_crawler_engine lnv_wc

//lnv_wc = create nvo_web_crawler_engine

lnv_wc.of_get_macro_directory("TEST")

//destroy lnv_wc
end event

type cb_caqh_roster from commandbutton within w_utilities5
integer x = 2030
integer y = 752
integer width = 919
integer height = 92
integer taborder = 470
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "CAQH Roster Utility"
end type

event clicked;//====================================================================
//$<Event>: clicked
//$<Arguments>:
//$<Return>:  long
//$<Description>: 
//$<Author>: (Appeon) long.zhang 05.14.2015 (v15.1 CAQH Roster Automation)
//--------------------------------------------------------------------
//$<Modify History>:
//====================================================================

Int i

i = Messagebox("About","This function is for manually synchronizing the CAQH Roster.~rContinue?",Question!,yesno!,1)
If i = 2 Then Return

Open(w_caqh_roster)


end event

type cb_copy_emailmsg from commandbutton within w_utilities5
integer x = 2030
integer y = 1424
integer width = 919
integer height = 92
integer taborder = 160
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Copy Email Messages"
end type

event clicked;//====================================================================
//$<Event>: clicked
//$<Arguments>:
// 	%ScriptArgs%
//$<Return>:  long
//$<Description>: 
//$<Author>: (Appeon) Stephen 06.03.2014 (copy email messages from different email type)
//--------------------------------------------------------------------
//$<Modify History>:
//====================================================================
int li_ret
string ls_sql

if gi_email_type = 1 then  //outlook
else  //easymail
	li_ret = messagebox("Prompt","This step is to copy the email template message: once the email sending approach is changed from Outlook to Easymail, it will copy the email_msg information set under the Outlook mode to the Email_Message field under Easymail (note: it’s only applicable to the null records of Email_Message). Continue to execute?", Question!,yesno!, 1)
	if li_ret = 2 then return
	ls_sql = "Update wf_email Set Email_Message = convert(varchar(8000),email_msg) Where (email_msg Is Not Null) AND (Email_Message is Null) "
end if

execute Immediate :ls_sql using sqlca;
commit using sqlca;

end event

type cb_sync_alias from commandbutton within w_utilities5
integer x = 69
integer y = 832
integer width = 896
integer height = 92
integer taborder = 450
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Field Alias Sync"
end type

event clicked;integer res
//res = messagebox("This operation:","This utility will add missing facility committees to current appointments.  Used when committees have been added to a facility after the appointments were created.  ~rContinue?",question!,yesno!,2)
//if res = 2 then return

open(w_alias_name_sync)
end event

type cb_psv from commandbutton within w_utilities5
integer x = 69
integer y = 1504
integer width = 896
integer height = 92
integer taborder = 140
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "PSV missing records"
end type

event clicked;Open(w_cvo_missing_data_utility)
end event

type cb_userdocs from commandbutton within w_utilities5
integer x = 69
integer y = 1888
integer width = 896
integer height = 92
integer taborder = 440
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "User Documents"
end type

event clicked; //Start Code Change ----01.26.2017 #V153 maha - added
open(w_user_documents_admin)
end event

type cb_sessions from commandbutton within w_utilities5
integer x = 69
integer y = 2080
integer width = 896
integer height = 92
integer taborder = 440
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "View User Sessions"
end type

event clicked;Open(w_session_info_utl)
end event

type cb_6 from commandbutton within w_utilities5
integer x = 69
integer y = 1312
integer width = 896
integer height = 92
integer taborder = 460
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "NAMSS PASS Settings"
end type

event clicked;open(w_namsspass_settings)
end event

type cb_namsspass_query from commandbutton within w_utilities5
boolean visible = false
integer x = 3323
integer y = 2176
integer width = 224
integer height = 92
integer taborder = 440
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Query"
end type

event clicked;open(w_namsspass_query)
end event

type cb_recruit_eva from commandbutton within w_utilities5
integer x = 174
integer y = 2652
integer width = 919
integer height = 92
integer taborder = 480
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Recruitment Evaluations"
end type

event clicked;open(w_recruitment_data)
end event

type cb_recdata_entry from commandbutton within w_utilities5
integer x = 274
integer y = 2792
integer width = 919
integer height = 92
integer taborder = 480
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Recruitment Data Entry"
end type

event clicked;  //open(w_recruit_mockup_1)
end event

type cb_ctx_utilities from commandbutton within w_utilities5
boolean visible = false
integer x = 41
integer y = 16
integer width = 475
integer height = 84
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Contracts Utilities"
end type

event clicked;//(Appeon)Harry 07.10.2013 - V141 ISG-CLX
open(w_utilities_contract)

end event

type cb_splash_set from commandbutton within w_utilities5
boolean visible = false
integer x = 1481
integer y = 2544
integer width = 896
integer height = 92
integer taborder = 470
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Splash Screen Picture Settings"
end type

event clicked;// (Appeon)Harry 06.11.2013 - V141 ISG-CLX
open(w_splah_screen_set)
end event

type cb_namsspass_upload from commandbutton within w_utilities5
integer x = 69
integer y = 1408
integer width = 896
integer height = 92
integer taborder = 450
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "NAMSS PASS Export"
end type

event clicked;open(w_namsspass_upload)
end event

type cb_gud from commandbutton within w_utilities5
integer x = 69
integer y = 928
integer width = 896
integer height = 92
integer taborder = 130
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Group Update Defaults"
end type

event clicked;integer r

 r = 	messagebox("About","This utility is for setting the defaults for the address update checkboxes from Group Locations. ~r~rDo you wish to continue?",Question!,yesno!,1)
if r = 2 then return


Open(w_group_update_defaults)
end event

type cb_batch_add from commandbutton within w_utilities5
integer x = 69
integer y = 1696
integer width = 896
integer height = 92
integer taborder = 240
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Screen Batch Setting"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for setting a Screen to be able to batch add.  Do not use without assistance of IntelliSoft Support.~r~rDo you wish to continue?",Question!,yesno!,1)
if r = 2 then return

open(w_sys_table_batch_setting)
end event

type cb_app_track_utl from commandbutton within w_utilities5
integer x = 69
integer y = 352
integer width = 896
integer height = 92
integer taborder = 580
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Application Tracking Record Utilities"
end type

event clicked;//open(w_validation_setup)
//open(w_sys_field_import)
//open(w_setup_central)
//open(w_call_log)
//open(w_mockup_1)
//openwithparm(w_exp_cred_create_util, "Utility")
//open(w_setup_window)
//open(w_wv_tracking_report)
//open(w_appl_track_utl )
//open(w_batch_add_oppe)
open(w_appl_tracking_cleanup)
end event

type cb_npdb_reload from commandbutton within w_utilities5
integer x = 2030
integer y = 1808
integer width = 919
integer height = 92
integer taborder = 160
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "NPDB Reload XML File"
end type

event clicked;//////////////////////////////////////////////////////////////////////
// $<event> clicked
// $<arguments>
// $<returns> long
// $<description> reload  XML file content into report tables
//                (V12.2 - NPDB QRXS)
//////////////////////////////////////////////////////////////////////
// $<add> Stephen 11.08.2012
//////////////////////////////////////////////////////////////////////

integer li_ret, li_cnt
string   ls_filepath, ls_file_name[]
n_cst_npdb lnvo_npdb

if messagebox("Prompt","The operation will overwrite the existing record in the DB,would you like to continue?",Question!,YesNo!) <> 1 then return

if DirectoryExists(gs_current_path+'\qrxs\Processed') then ChangeDirectory(gs_current_path+'\qrxs\Processed')

li_ret = GetFileOpenName("Select File",	ls_filepath, ls_file_name, "XML", "XML Files (*.XML),*.XML")
if li_ret = 1 then
	if upperbound(ls_file_name) > 1 then
		for li_cnt = 1 to upperbound(ls_file_name)
			ls_file_name[li_cnt] = ls_filepath + '\' + ls_file_name[li_cnt]
		next
	else
		ls_file_name[1] = ls_filepath
	end if
	
	if upperbound(ls_file_name) > 0 then
		
		lnvo_npdb = create n_cst_npdb
		if lnvo_npdb.of_get_qrxs_report_reload(ls_file_name) = 1 then
			messagebox("Success", "The NPDB file was imported successfuly !")
		else
			messagebox("Failed", " Failed to import the NPDB file !")
		end if
		
		destroy lnvo_npdb
	end if
end if

ChangeDirectory(gs_current_path)
end event

type cb_lookup_cleanup from commandbutton within w_utilities5
integer x = 69
integer y = 1120
integer width = 896
integer height = 92
integer taborder = 580
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Lookup List Cleanup"
end type

event clicked;//open(w_validation_setup)
//open(w_sys_field_import)
//open(w_setup_central)
open(w_lookup_maint_cleanup)
//open(w_mockup_1)
//openwithparm(w_exp_cred_create_util, "Utility")
//open(w_setup_window)
//open(w_wv_tracking_report)
//open(w_appl_track_utl )
//open(w_batch_add_oppe)

end event

type cb_email_sent_items from commandbutton within w_utilities5
integer x = 69
integer y = 736
integer width = 896
integer height = 92
integer taborder = 160
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Email Sent Items"
end type

event clicked;//////////////////////////////////////////////////////////////////////
// $<event> clicked()
// $<arguments>
// $<returns> integer
// $<description> N/A
//////////////////////////////////////////////////////////////////////
// $<add> 06.18.2012 by Evan
//////////////////////////////////////////////////////////////////////

//---------Begin Modified by (Appeon)Harry 07.29.2013 for V141 ISG-CLX--------
//OpenWithParm(w_email_sent_items, "Administrator!")
OpenSheet(w_email_folder, w_mdi, 4, Original!) 	

//---------End Modfiied ------------------------------------------------------


end event

type cb_images from commandbutton within w_utilities5
integer x = 69
integer y = 1216
integer width = 896
integer height = 92
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Migrate Images to DB"
end type

event clicked;open(w_image_to_db_conversion_utility)
end event

type cb_5 from commandbutton within w_utilities5
integer x = 2030
integer y = 1040
integer width = 919
integer height = 92
integer taborder = 580
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Checklist Irregularities"
end type

event clicked;integer res
res = messagebox("This operation:","This utility will chek for duplicate ids in the checklist temple items and correct including updating connected Provider Checklist items.  ~rContinue?",question!,yesno!,2)
if res = 2 then return

open(w_dvaa_util_bad_ids )

end event

type cb_group_painter from commandbutton within w_utilities5
integer x = 3323
integer y = 1632
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Group Data Screen Setup)"
end type

event clicked;integer res
//res = messagebox("This operation:","This utility is a painter for the Group Location Data screen detail field labels.  Visiblility can also be set on those fields.    ~rContinue?",question!,yesno!,1)
if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->Screen Setup")
end if

Open(w_group_data_screen_painter)
end event

type cb_app_tracking_setup from commandbutton within w_utilities5
integer x = 3323
integer y = 1420
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Application Tracking Setup)"
end type

event clicked;if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->System Setup")
end if

open(w_app_tracker_setup)
end event

type cb_standing from commandbutton within w_utilities5
integer x = 3323
integer y = 2060
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Standing Lookup Edit)"
end type

event clicked;if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->Lookups")
end if
open(w_standing_lookup_edit)  //Start Code Change ---- 11.07.2006 #1 maha changed back to this window to separate user functions from security settings.
end event

type cb_reg from commandbutton within w_utilities5
integer x = 69
integer y = 1600
integer width = 896
integer height = 92
integer taborder = 120
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Register DLL/OCX"
end type

event clicked;Open(w_register_ocx) //alfee 01.07.2010
end event

type cb_alert_audit from commandbutton within w_utilities5
integer x = 2030
integer y = 272
integer width = 919
integer height = 92
integer taborder = 550
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Alert Audit"
end type

event clicked;// Add by andy 01/07/2010 V10.1 - Notification Alert
OpenWithParm(w_alert_audit,"")
end event

type cb_caqh_settings from commandbutton within w_utilities5
integer x = 69
integer y = 448
integer width = 896
integer height = 92
integer taborder = 400
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "CAQH Import Default Settings"
end type

event clicked;
open(w_caqh_default_settings)
end event

type cb_overview from commandbutton within w_utilities5
integer x = 1042
integer y = 1796
integer width = 919
integer height = 100
integer taborder = 370
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "System SnapShot"
end type

event clicked;
open(w_system_overview)


end event

type cb_hvc from commandbutton within w_utilities5
integer x = 1047
integer y = 2116
integer width = 919
integer height = 100
integer taborder = 230
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Verif: Historical and Date Check"
end type

event clicked;integer r
string ls_ver_ck
//
//messagebox("About","This function will check Attestation Data for facility Id values out of sync with Appointment Parent facility.")
////if r = 2 then return

open(w_hist_exp_cred_clean)


end event

type cb_aquest_sync from commandbutton within w_utilities5
integer x = 1042
integer y = 820
integer width = 919
integer height = 100
integer taborder = 450
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Attest Question Facility Sync"
end type

event clicked;integer r
string ls_ver_ck

messagebox("About","This function will check Attestation Data for facility Id values out of sync with Appointment Parent facility.")
//if r = 2 then return

open(w_attest_quest_sync_utility)


end event

type cb_importphoto from commandbutton within w_utilities5
integer x = 2030
integer y = 1520
integer width = 919
integer height = 92
integer taborder = 530
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Import Photos"
end type

event clicked;
long		ll_Cycle,ll_Cnts,ll_Prefix,ll_ExistInBasic,ll_ExistInPhoto,ll_FileNo,ll_ReadCnts,ll_Rtn
String	ls_PicPath,ls_PicName,ls_AllPic[],ls_Prefix,ls_Postfix
BLOB		lblb_ImageData,lblb_Buffer

CONSTANT STRING SEPCHAR = "*"

ls_PicPath = TRIM(gnv_data.of_getitem("ids","picture_path",false))
if RightA(ls_PicPath,1) <> "\" then ls_PicPath += "\"

ll_Rtn = MessageBox(gnv_app.iapp_object.DisplayName,"This utility is to upload the photo files from the ~"" + ls_PicPath + "~" folder to the database.~r~n~r~nDo you want to continue?",Question!,YesNo!,1)
if ll_Rtn <> 1 then Return
//Start Code Change ----03-16-2009.2009 #V92 maha - modified to display progress window
openwithparm(w_import_prac_photos_2013, "P")

return

//SetPointer(HourGlass!)
//
//f_SetFileSrv(inv_filesrv,TRUE)
//
//inv_filesrv.of_DirList(ls_PicPath + "*.bmp",0,inv_DirAttribBMP)
//inv_filesrv.of_DirList(ls_PicPath + "*.jpg",0,inv_DirAttribJPG)
//inv_filesrv.of_DirList(ls_PicPath + "*.gif",0,inv_DirAttribGIF)
//
//ls_Prefix = SEPCHAR
//
//ll_Cnts = UpperBound(inv_DirAttribBMP)
//for ll_Cycle = 1 to ll_Cnts
//	ls_PicName = inv_DirAttribBMP[ll_Cycle].is_FileName
//	//if Pos(ls_Prefix,SEPCHAR + Left(ls_PicName,LastPos(ls_PicName,".") - 1) + SEPCHAR) > 0 then CONTINUE
//	ls_Prefix += Left(ls_PicName,LastPos(ls_PicName,".") - 1) + SEPCHAR
//	ls_AllPic[UpperBound(ls_AllPic) + 1] = ls_PicName
//next
//
//ll_Cnts = UpperBound(inv_DirAttribJPG)
//for ll_Cycle = 1 to ll_Cnts
//	ls_PicName = inv_DirAttribJPG[ll_Cycle].is_FileName
//	if Pos(ls_Prefix,SEPCHAR + Left(ls_PicName,LastPos(ls_PicName,".") - 1) + SEPCHAR) > 0 then CONTINUE
//	
//	ls_Prefix += Left(ls_PicName,LastPos(ls_PicName,".") - 1) + SEPCHAR
//	ls_AllPic[UpperBound(ls_AllPic) + 1] = ls_PicName
//next
//
//ll_Cnts = UpperBound(inv_DirAttribGIF)
//for ll_Cycle = 1 to ll_Cnts
//	ls_PicName = inv_DirAttribGIF[ll_Cycle].is_FileName
//	if Pos(ls_Prefix,SEPCHAR + Left(ls_PicName,LastPos(ls_PicName,".") - 1) + SEPCHAR) > 0 then CONTINUE
//	
//	//ls_Prefix += Left(ls_PicName,LastPos(ls_PicName,".") - 1) + SEPCHAR
//	ls_AllPic[UpperBound(ls_AllPic) + 1] = ls_PicName
//next
//
//ll_Cnts = UpperBound(ls_AllPic)
//for ll_Cycle = 1 to ll_Cnts
//	ls_PicName = ls_AllPic[ll_Cycle]
//	ls_Prefix = Left(ls_PicName,LastPos(ls_PicName,".") - 1)
//	ls_Postfix = Mid(ls_PicName,LastPos(ls_PicName,".") + 1)
//	if IsNumber(ls_Prefix) then
//		ll_Prefix = long(ls_Prefix)
//		SELECT Count(*) INTO :ll_ExistInBasic from pd_basic WHERE pd_basic.prac_id = :ll_Prefix ;
//		if ll_ExistInBasic <= 0 then CONTINUE
//		
//		SELECT Count(*) INTO :ll_ExistInPhoto from pd_photo WHERE pd_photo.prac_id = :ll_Prefix ;
//		if ll_ExistInPhoto <= 0 then
//			INSERT INTO pd_photo(prac_id,image_type) VALUES(:ll_Prefix,:ls_Postfix) ;
//		end if
//		
//		ll_FileNo = FileOpen(ls_PicPath + ls_PicName,StreamMode!,Read!)
//		if ll_FileNo <= 0 then CONTINUE
//		
//		lblb_ImageData = Blob("")				//Reset lblb_ImageData
//		ll_ReadCnts = FileRead(ll_FileNo,lblb_Buffer)
//		do while ll_ReadCnts > 0
//			lblb_ImageData += lblb_Buffer
//			ll_ReadCnts = FileRead(ll_FileNo,lblb_Buffer)
//		loop
//		
//		FileClose(ll_FileNo)
//		
//		UPDATE pd_photo SET image_type = :ls_Postfix WHERE pd_photo.prac_id = :ll_Prefix ;
//		UPDATEBLOB pd_photo SET image_data = :lblb_ImageData WHERE pd_photo.prac_id = :ll_Prefix ;
//	end if
//next
//
//f_SetFileSrv(inv_filesrv,false)
//
//MessageBox(gnv_app.iapp_object.DisplayName,"Upload is complete!")
//
//SetPointer(Arrow!)
//
end event

type cb_set_facility_app_label from commandbutton within w_utilities5
integer x = 3323
integer y = 1740
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(IntelliApp Header Painter)"
end type

event clicked;if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->Screen Setup")
end if
open(w_facility_app_label)
end event

type cb_fixfax from commandbutton within w_utilities5
integer x = 1042
integer y = 1252
integer width = 919
integer height = 100
integer taborder = 170
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Format Phone/Fax numbers"
end type

event clicked;integer r
string ls_ver_ck

// r = 	messagebox("About","This function will clear dba. values from export filters and practitioner queries.~rContinue?",Question!,yesno!,1)
//if r = 2 then return

open(w_format_phone_numbers_utl)


end event

type cb_npdb from commandbutton within w_utilities5
integer x = 2030
integer y = 1712
integer width = 919
integer height = 92
integer taborder = 510
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "NPDB Specialty Utility"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<add> 04.27.2007 By: Jack
open(w_npdb_specialty_matching)
//---------------------------- APPEON END ----------------------------

end event

type cb_view_alias from commandbutton within w_utilities5
integer x = 2030
integer y = 2000
integer width = 919
integer height = 92
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "View Alias Maintenance"
end type

event clicked;//$<add> 02.19.2008 by Andy
Open(w_view_alias_maintenance)
end event

event rbuttondown;
//alfee 10.15.2010

if gs_dbtype = 'SQL' then
	open(w_view_fields_mapping)
end if
end event

type cb_migrate from commandbutton within w_utilities5
boolean visible = false
integer x = 2039
integer y = 2380
integer width = 896
integer height = 92
integer taborder = 410
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
boolean enabled = false
string text = "Migrate Test Data"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility id for importing/Exporting data from test systems for specific Modules..~r~rDo you wish to continue?",Question!,yesno!,1)
if r = 2 then return

open(w_data_migration)
end event

type cb_updae_sql from commandbutton within w_utilities5
integer x = 2030
integer y = 1904
integer width = 919
integer height = 92
integer taborder = 490
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Reset Contract Screen SQL"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<add> 04.27.2007 By: Jack
open(w_contract_screen)
//---------------------------- APPEON END ----------------------------

end event

type cb_wc_setup from commandbutton within w_utilities5
integer x = 3063
integer y = 932
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Web Crawl Setup)"
end type

event clicked;//integer r

// r = 	messagebox("About","This utility is for creating non- practitioner records available for inclusion in meeting attendance.   ~r~rDo you wish to continue?",Question!,yesno!,1)
//if r = 2 then return
if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->System Setup")
end if

open(w_web_crawler_user_info)
end event

type cb_crawls from commandbutton within w_utilities5
integer x = 1047
integer y = 280
integer width = 923
integer height = 92
integer taborder = 560
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Import Web Crawls"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for importing IntelliCred Web Crawler data.  Contact Intellisoft Group to get import files.  Continue?",Question!,yesno!,2)
if r = 2 then return

//messagebox("About","This function not yet complete.")
//return
Open( w_import_webcrawler ) 
end event

type cb_dba from commandbutton within w_utilities5
integer x = 1042
integer y = 1036
integer width = 919
integer height = 100
integer taborder = 270
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Clean dba. from export data"
end type

event clicked;integer r
string ls_ver_ck

 r = 	messagebox("About","This function will clear dba. values from export filters and practitioner queries.~rContinue?",Question!,yesno!,1)
if r = 2 then return

open(w_utl_strip_dba_from_export)


end event

type cb_sec_paint from commandbutton within w_utilities5
integer x = 3323
integer y = 1952
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Security Painter)"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

// R. Avital v11.3 BugM082101
// Prevent this event from executing
// When user presses Esc. key
// IF/Then check on ik_keycode
IF ik_keycode = KeyEscape! THEN
	SetNull(ik_keycode)
	RETURN 0
ELSE
	// r = 	messagebox("About","This allows resetting a user expiration date to today to allow the user to log in and change their password.  It also includes Settings for password expiration and program timeout.~r~rDo you wish to continue?",Question!,yesno!,1)
	//if r = 2 then return
	if not gb_sk_ver then
		messagebox("Moved","This utility has been moved to the menu under System->Setup->Security")
	end if
	open(w_security_painter)
END IF

end event

type cb_nonprac from commandbutton within w_utilities5
integer x = 3323
integer y = 1848
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Non-Practitioner Painter)"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

// r = 	messagebox("About","This utility is for creating non- practitioner records available for inclusion in meeting attendance.   ~r~rDo you wish to continue?",Question!,yesno!,1)
//if r = 2 then return
if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->System Setup")
end if

openwithparm(w_non_prac_painter,"A")
end event

type cb_caqh_codes from commandbutton within w_utilities5
integer x = 2030
integer y = 656
integer width = 919
integer height = 92
integer taborder = 460
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "CAQH Mapping Fields"
end type

event clicked;integer r

 r = 	messagebox("About","This function is for manually replacing the CAQH import mapping fields.~rContinue?",Question!,yesno!,1)
if r = 2 then return



open(w_caqh_update_mapping_fields)


end event

type cb_caqh_fields from commandbutton within w_utilities5
integer x = 4325
integer y = 1744
integer width = 919
integer height = 92
integer taborder = 470
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Add CAQH Fields to Views"
end type

event clicked;integer r


open(w_caqh_add_fields)


end event

type cb_screen_view from commandbutton within w_utilities5
integer x = 69
integer y = 1792
integer width = 896
integer height = 92
integer taborder = 420
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Screen View Utility"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for setting screen aliases and reference field values.  Do not use without assistance of IntelliSoft Support.~r~rDo you wish to continue?",Question!,yesno!,1)
if r = 2 then return

open(w_ref_field_update)
end event

type cb_paths from commandbutton within w_utilities5
integer x = 1042
integer y = 1904
integer width = 919
integer height = 100
integer taborder = 240
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Test Paths"
end type

event clicked;integer r
string ls_ver_ck

 r = 	messagebox("About","This function will check to see if program paths are valid.~rContinue?",Question!,yesno!,1)
if r = 2 then return

n_cst_rights LNVO_RIGHTS
LNVO_RIGHTS = create n_cst_rights
ls_ver_ck = LNVO_RIGHTS.OF_start( )
if ls_ver_ck = "OK" then
	messagebox("Path Test","No problems found")
else
	openwithparm( w_sql_msg,ls_ver_ck)
end if
destroy LNVO_RIGHTS


end event

type cb_4 from commandbutton within w_utilities5
integer x = 2030
integer y = 368
integer width = 919
integer height = 92
integer taborder = 250
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Application Mod Audit"
end type

event clicked;integer r

// r = 	messagebox("About","This function will the IDs table to make sure prac_ids, rec_ids, lookup_codes,etc. are in sync.~rWill NOT work for rec_id on custom tables.~rContinue?",Question!,yesno!,2)
//if r = 2 then return
//
open(w_appl_tracking_utl)


end event

type cb_index from commandbutton within w_utilities5
integer x = 2030
integer y = 176
integer width = 919
integer height = 92
integer taborder = 130
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Additional indexes"
end type

event clicked;string ls_sql
integer r
long fid = 9810 //expiration date

 r = 	messagebox("About","This function will add additional indexes to the database that may improve performance. It is best to run this with only one user in the system.~r~rContinue?",Question!,yesno!,2)
if r = 2 then 
	return
else
	open (w_add_indexes_v5)
end if


end event

type cb_date_fields from commandbutton within w_utilities5
integer x = 4329
integer y = 1952
integer width = 919
integer height = 92
integer taborder = 480
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Add New Date Fields to Views"
end type

event clicked;integer r

// r = 	messagebox("About","This function will clear double quotes in all Credentialing Data screen labels and text items.~rContinue?",Question!,yesno!,2)
//if r = 2 then return
//
open(w_add_new_date_fields)


end event

type cb_appt_painter from commandbutton within w_utilities5
integer x = 3323
integer y = 1528
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "(Appointment Status Painter)"
end type

event clicked;integer res
//res = messagebox("This operation:","This utility is a painter for some of the Appointment Status detail field labels.  Validation can also be set on those fields.    ~rContinue?",question!,yesno!,1)
if not gb_sk_ver then
	messagebox("Moved","This utility has been moved to the menu under System->Setup->Screen Setup")
end if



Open(w_appt_stat_painter)
end event

type cb_clear_quotes from commandbutton within w_utilities5
integer x = 2030
integer y = 1136
integer width = 919
integer height = 92
integer taborder = 210
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Clear Quotes from Labels"
end type

event clicked;integer r

 r = 	messagebox("About","This function will clear double quotes in all Credentialing Data screen labels and text items.~rContinue?",Question!,yesno!,2)
if r = 2 then return

openwithparm(w_utl_label_strip_quote,"P")


end event

type cb_prem_utl from commandbutton within w_utilities5
boolean visible = false
integer x = 4325
integer y = 1848
integer width = 923
integer height = 92
integer taborder = 150
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "iPrem Utilities"
end type

event clicked;integer res
//res = messagebox("This operation:","This utility will add missing facility committees to current appointments.  Used when committees have been added to a facility after the appointments were created.  ~rContinue?",question!,yesno!,2)

//Open(w_premium_sync)






end event

type cb_selects from commandbutton within w_utilities5
integer x = 69
integer y = 172
integer width = 896
integer height = 92
integer taborder = 380
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "SQL Selects"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This will allow the user run and export sql queries.~r~rDo you wish to continue?",Question!,yesno!,1)
if r = 2 then return

open(w_sql_select_only)
end event

type cb_check_ids from commandbutton within w_utilities5
integer x = 2030
integer y = 944
integer width = 919
integer height = 92
integer taborder = 220
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Check IDs"
end type

event clicked;integer r

 r = 	messagebox("About","This function will validate the IDs table to make sure prac_ids, rec_ids, lookup_codes,etc. are in sync.~rWill NOT work for rec_id on custom tables.~rContinue?",Question!,yesno!,2)
if r = 2 then return

open(w_ids_check)


end event

type cb_exp_not_comp from commandbutton within w_utilities5
integer x = 1042
integer y = 1144
integer width = 919
integer height = 100
integer taborder = 260
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Exp Verifications not Completed "
end type

event clicked;integer r

 r = 	messagebox("About","This function will display an updateable list of all incompleted expiring verifications where the expiration date is beyond today's date.~rFor items beyond 30 days, this could indicate the data record was completed but not the verification.~rContinue?",Question!,yesno!,2)
if r = 2 then return

openwithparm(w_utl_incomplete_exp_verifs,"P")


end event

type cb_registry from commandbutton within w_utilities5
boolean visible = false
integer x = 3109
integer y = 1308
integer width = 919
integer height = 92
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Set Registry Path"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This will set the registry key to allow a user to run the program from other than the C drive.~r~rDo you wish to continue?",Question!,yesno!,1)
if r = 2 then return

openwithparm(w_utl_set_regedit_path,"P")
end event

type cb_user_reset from commandbutton within w_utilities5
integer x = 69
integer y = 2272
integer width = 896
integer height = 92
integer taborder = 360
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "User Reset Utilities"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

// r = 	messagebox("About","This allows resetting a user expiration date to today to allow the user to log in and change their password.  It also includes Settings for password expiration and program timeout.~r~rDo you wish to continue?",Question!,yesno!,1)
//if r = 2 then return
//
//open(w_security_set)
open(w_user_reset)  //Start Code Change ---- 11.07.2006 #1 maha changed back to this window to separate user functions from security settings.
end event

type cb_bd_exp from commandbutton within w_utilities5
integer x = 4325
integer y = 1640
integer width = 919
integer height = 92
integer taborder = 350
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "New Board/Specialty Fields"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<ID> PT-01
//$<modify> 02.23.2006 By: owen chen
//$<reason> Performance tuning
//$<modification> Add Appeon Queue labels to reduce client-server interactions to improve runtime performance.

/*
integer r
integer dvid
integer rc
integer v
integer find
integer vc
integer a
long fid = 9810 //expiration date

 r = 	messagebox("About","This function will Copy the new specialty exp date and certified fields to all views, and set the Bd/Spec expiration field to expiration date, and create expiration date data from certificate expires.~r~rContinue?",Question!,yesno!,2)
if r = 2 then return

SetPointer ( hourglass! )
debugbreak()
dw_data_view_list.settransobject(sqlca)
vc = dw_data_view_list.retrieve()
dw_dvfieldcopy.settransobject(sqlca)

for a = 1 to 2
	if a = 2 then fid = 9811 //board certified
	dw_dvfieldcopy.reset()
	rc = dw_dvfieldcopy.retrieve(fid)
	for v = 1 to vc  //go down list of views and add if not found
		dvid = dw_data_view_list.getitemnumber(v,"data_view_id")
		find = dw_dvfieldcopy.Find ( "data_view_id = " + string(dvid), 1, vc )
		if find < 0 then
			messagebox("","bad find")
			return
			end if
		if find = 0 then 
			dw_dvfieldcopy.rowscopy(1,1,primary!,dw_dvfieldcopy,1000,primary!)
			dw_dvfieldcopy.setitem(dw_dvfieldcopy.rowcount(),"data_view_id",dvid)
		end if
	next
	dw_dvfieldcopy.update()
	commit using sqlca;
next
		

//update exp dv field
update data_view_screen set exp_field = 9810 where screen_id =  19;

//update exp data
update pd_board_specialty set expiration_date = string(certification_expires) + '-12-30' + ' 00:00:00' where certification_expires is not null and expiration_date is null;

//update certified
update pd_board_specialty set board_certified = 581 where board_code is not null;
update pd_board_specialty set board_certified = 582 where board_code is null;
*/
integer r
integer dvid
integer rc
integer v
integer find
integer vc
integer a
long fid = 9810 //expiration date

r = messagebox("About","This function will Copy the new specialty exp date and certified fields to all views, and set the Bd/Spec expiration field to expiration date, and create expiration date data from certificate expires.~r~rContinue?",Question!,yesno!,2)
if r = 2 then return

SetPointer ( hourglass! )
debugbreak()
dw_data_view_list.settransobject(sqlca)
vc = dw_data_view_list.retrieve()
dw_dvfieldcopy.settransobject(sqlca)

for a = 1 to 2
	if a = 2 then fid = 9811 //board certified
	dw_dvfieldcopy.reset()
	rc = dw_dvfieldcopy.retrieve(fid)
	for v = 1 to vc  //go down list of views and add if not found
		dvid = dw_data_view_list.getitemnumber(v,"data_view_id")
		//--------------------------- APPEON BEGIN ---------------------------
		//$<modify> 04.01.2006 By: LiuHongXin
		//$<reason> Fix a defect.
		/*
		find = dw_dvfieldcopy.Find ( "data_view_id = " + string(dvid), 1, vc )
		*/
		find = dw_dvfieldcopy.Find ( "data_view_id = " + string(dvid), 1, rc )
		//---------------------------- APPEON END ----------------------------
		if find < 0 then
			messagebox("","bad find")
			return
			end if
		if find = 0 then 
			dw_dvfieldcopy.rowscopy(1,1,primary!,dw_dvfieldcopy,1000,primary!)
			dw_dvfieldcopy.setitem(dw_dvfieldcopy.rowcount(),"data_view_id",dvid)
		end if
	next
next

gnv_appeondb.of_startqueue( )
		
dw_dvfieldcopy.update()
commit using sqlca;

//update exp dv field
update data_view_screen set exp_field = 9810 where screen_id =  19;
//update exp data
update pd_board_specialty set expiration_date = convert(char(4),certification_expires) + '-12-30' + ' 00:00:00' where certification_expires is not null and expiration_date is null;
//update certified
update pd_board_specialty set board_certified = 581 where board_code is not null;
update pd_board_specialty set board_certified = 582 where board_code is null;

gnv_appeondb.of_commitqueue( )

//---------------------------- APPEON END ----------------------------

SetPointer ( arrow! )
messagebox("Done"," Update Completed")
end event

type cb_comp_info from commandbutton within w_utilities5
integer x = 2030
integer y = 1328
integer width = 919
integer height = 92
integer taborder = 340
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Company Information (Invoice)"
end type

event clicked;integer res
//res = messagebox("This operation:","This utility will add missing facility committees to current appointments.  Used when committees have been added to a facility after the appointments were created.  ~rContinue?",question!,yesno!,2)

open(w_company_info)






end event

type cb_requested from commandbutton within w_utilities5
integer x = 4325
integer y = 1536
integer width = 919
integer height = 92
integer taborder = 200
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Set Staff Cat Status "
end type

event clicked;integer r

 r = 	messagebox("About","This function will update the status value for all Staff Category records based on to_date.~rDate  = inactive; no date = active.~r~rContinue?",Question!,yesno!,2)
if r = 2 then return

string ls_sql


update pd_affil_staff_cat set requested = 0 where to_date is not null;
update pd_affil_staff_cat set requested = 1 where to_date is null;
commit using sqlca;

 r = 	messagebox("Requested","Do you want to update the status of records where there is no FROM or TO dates to 'Requested' status?",Question!,yesno!,2)
if r = 1 then 
	update pd_affil_staff_cat set requested = 2 where to_date is null and from_date is null;
	commit using sqlca;
end if

messagebox("Done"," Update Completed")
end event

type cb_field_ord_chk from commandbutton within w_utilities5
integer x = 1042
integer y = 928
integer width = 919
integer height = 100
integer taborder = 180
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Check Field Order "
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility will check for and correct duplicated field orders on the default data view which could cause app populating problems. Continue?",Question!,yesno!,2)
if r = 2 then return

Openwithparm(w_utl_dvf_order_check,"P" )


end event

type cb_iapp_fix from commandbutton within w_utilities5
integer x = 1042
integer y = 1364
integer width = 919
integer height = 100
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Intelliappfix Search"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob


Open( w_iapp_fix_login )

if Lower( Message.StringParm ) = "cancel"  THEN
	return
elseIF Lower( Message.StringParm ) = "intelliappfix"  THEN
	Open( w_iapp_find_row )
ELSE
	MessageBox( "Sorry", "Wrong password." )
END IF
end event

type cb_multi_affil_check from commandbutton within w_utilities5
integer x = 1042
integer y = 712
integer width = 919
integer height = 100
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Appointment Aberrations Check"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for checking for abnormal appointment records for practitioners. Continue?",Question!,yesno!,2)
if r = 2 then return

//messagebox("About","This function not yet complete.")
//return
openwithparm(w_utl_multi_nonhist_check, "P")
end event

type cb_dapplications from commandbutton within w_utilities5
boolean visible = false
integer x = 3561
integer y = 2176
integer width = 174
integer height = 92
integer taborder = 520
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Download Applications"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for downloading IntelliApp Applications from the Intellisoft Group Website. Continue?",Question!,yesno!,2)
if r = 2 then return

//messagebox("About","This function not yet complete.")
//return
Openwithparm( w_import_apps,"P" ) //P indicated open from intellicred
end event

type cb_dmanual from commandbutton within w_utilities5
integer x = 1047
integer y = 172
integer width = 923
integer height = 92
integer taborder = 500
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Download Current Manual"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for downloading the latest Manual from the Intellisoft Group Website. Continue?",Question!,yesno!,1)
if r = 2 then return

String sle_url
inet iinet_base

//---------Begin Modified by (Appeon)Harry 04.07.2016 for Bug #5095--------
//messagebox("About","Enter your assigned user name and password for the IntelliSoft Group website. If you don't know it, contact IntelliSoft Group Support.~r Go to Download Center.  Select the manual you desire and click download.~r SAVE to your computer.")
//of_open_web("http://www.intellisoftgroup.com/forum/login_user.asp") //Start Code Change ---- 06.20.2007 #V7 maha
messagebox("About","Enter your assigned user name and password for the IntelliSoft Group website. If you don't know it, contact IntelliSoft Group Support.~r Go to Documents.  Select the manual you desire and click to download.~r SAVE to your computer.")
of_open_web("https://customerportal.intellisoftgroup.com/") 
//---------End Modfiied ------------------------------------------------------
//GetContextService("Internet", iinet_base)
//iinet_base.HyperlinkToURL("http://www.intellisoftgroup.com/customer/customer.html")

end event

type cb_print_reset from commandbutton within w_utilities5
integer x = 2030
integer y = 560
integer width = 919
integer height = 92
integer taborder = 290
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Batch Reset Print Flags"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for Batch resetting verification print flags when the 'Did the letters print ok' is answered Yes by mistake. Continue?",Question!,yesno!,2)
if r = 2 then return

//messagebox("About","This function not yet complete.")
//return
open(w_utl_print_reset)
end event

type cb_assignedusers from commandbutton within w_utilities5
integer x = 2030
integer y = 848
integer width = 919
integer height = 92
integer taborder = 310
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Change Assigned Users "
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for updating the assigned users for Appointments and verifications. Continue?",Question!,yesno!,2)
if r = 2 then return

//messagebox("About","This function not yet complete.")
//return
//open(w_user_update_new)
open(w_user_assignment)
end event

type cb_oig from commandbutton within w_utilities5
integer x = 2030
integer y = 2096
integer width = 919
integer height = 92
integer taborder = 300
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Update OIG Data"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for updating OIG data. Continue?",Question!,yesno!,2)
if r = 2 then return

open(w_import_oig)
end event

type st_2 from statictext within w_utilities5
integer x = 3022
integer y = 1884
integer width = 91
integer height = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
boolean focusrectangle = false
end type

event clicked;integer res

res = messagebox("Abuse Easter Egg" , "Oh no " + gs_user_id + " !" + "~nYou found the hidden Easter egg: the customer abuse zone; the place where the program abusues the user.~n~nYour one chance to avoid this is to click NO.~n~nIf you click yes, just remember, you asked for it.",Exclamation!,Yesno!,1)

if res = 1 then
	open (w_user_abuse)
else
	messagebox("I Lied!","I'm not going to let you off the hook!")
	messagebox("Just Kidding","Get back to work!")
end if
end event

type cb_user_security from commandbutton within w_utilities5
integer x = 1042
integer y = 2012
integer width = 919
integer height = 100
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "User Security Utilities"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This will clean up user view and facility security.~r~rDo you wish to continue?",Question!,yesno!,2)
if r = 2 then return

openwithparm(w_user_security_fix,1)
end event

type cb_docids from commandbutton within w_utilities5
integer x = 1042
integer y = 1580
integer width = 919
integer height = 100
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Reset Verification Doc Ids"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This will reset all doc_ids values for all verifications to correct any that have gotten out of sync.~r~rDo you wish to continue?",Question!,yesno!,2)
if r = 2 then return

open(w_doc_id_reset_utility)
end event

type cb_stat_check from commandbutton within w_utilities5
integer x = 1042
integer y = 1688
integer width = 919
integer height = 100
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Sync Appointment Child Data"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility will check all appointment status records and match the active status/facility id of ~rchild records (Department, Staff Category, Leave, Committees).~r~rDo you wish to continue?",Question!,yesno!,2)
if r = 2 then return

open(w_check_active_stats)
end event

type cb_support_settings from commandbutton within w_utilities5
integer x = 2139
integer y = 20
integer width = 265
integer height = 84
integer taborder = 570
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "&Support"
end type

event clicked;//Open( w_function_password )
//
//
//IF Lower( Message.StringParm ) = "intelliset5"  THEN
	open(w_utilities_support)
//ELSE
//	MessageBox( "Sorry", "Wrong password." )
//END IF
end event

type cb_priv_adj from commandbutton within w_utilities5
integer x = 1042
integer y = 604
integer width = 919
integer height = 100
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Adjust Privileges"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for adjusting privilege deliniation.~r~rDo you wish to continue?",Question!,yesno!,2)
if r = 2 then return

open(w_privilege_adjustments)
end event

type cb_comm_review_fix from commandbutton within w_utilities5
integer x = 2030
integer y = 1232
integer width = 919
integer height = 92
integer taborder = 320
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Committee Review Fix"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for adding missing committees to active Appointments the have NONE.~r~rDo you wish to continue?",Question!,yesno!,2)
if r = 2 then return

open(w_comm_review_fix)
end event

type cb_links from commandbutton within w_utilities5
integer x = 1042
integer y = 1472
integer width = 919
integer height = 100
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Links Fix Utility"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob

 r = 	messagebox("About","This utility is for adding missing Address, Specialty, or Hospital links,as well as for deleting bad ones.~r~rDo you wish to continue?",Question!,yesno!,2)
if r = 2 then return

open(w_link_check_utility)
//open(w_link_check_utility_v9)
end event

type cb_db_back from commandbutton within w_utilities5
integer x = 2030
integer y = 464
integer width = 919
integer height = 92
integer taborder = 280
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Back Up Database"
end type

event clicked;integer res


//--------------------------- APPEON BEGIN ---------------------------
//$<modify> 2005-11-25 By: Zhang Lingping
//$<reason> can not backup SQL database from apllication 

if gs_dbtype = 'ASA' then
	res = messagebox("This operation:","This utility will allow you to back up your Intellicred datebase.  ~rContinue?",question!,yesno!,1)
	if res = 1 then 
		open(w_data_backup)
	end if
else
	messagebox("This operation:","The MS SQL Database cannot be backed up by this uility!")
end if
	
//---------------------------- APPEON END ----------------------------
end event

type cb_fix from commandbutton within w_utilities5
integer x = 4325
integer y = 1432
integer width = 919
integer height = 92
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = " Fix DOB Year"
end type

event clicked;integer r
integer rc
integer d
integer m
integer yr
date dob


 r = 	messagebox("About","This function will correct any prac dob that shows a year greater than 2000",Question!,yesno!,2)
if r = 2 then return
dw_3.settransobject(sqlca)
rc = dw_3.retrieve()
for r = 1 to rc
	 yr = year(date(dw_3.getitemdatetime(r,"date_of_birth"))) 
	 //messagebox("yr",yr)
if yr > 2000 then		
	yr = yr - 100
	//messagebox("yr-100",yr)
	m = month(date(dw_3.getitemdatetime(r,"date_of_birth")))
	d = day(date(dw_3.getitemdatetime(r,"date_of_birth")))
	dob = date(string(yr)  + "/" + string(m) + "/" + string(d))
	//messagebox("",string(dob))
	dw_3.setitem(r,"date_of_birth",datetime(dob))
end if
next

dw_3.update()
commit using sqlca;


	messagebox("done","Completed")
end event

type dw_3 from datawindow within w_utilities5
boolean visible = false
integer x = 3168
integer y = 876
integer width = 247
integer height = 92
string dataobject = "d_fix_dob"
boolean hscrollbar = true
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

event constructor;this.settransobject(sqlca)

end event

type cb_3 from commandbutton within w_utilities5
integer x = 2715
integer y = 20
integer width = 265
integer height = 84
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "&Close"
boolean cancel = true
end type

event clicked;CLOSE(PARENT)
end event

type cb_2 from commandbutton within w_utilities5
integer x = 2030
integer y = 2192
integer width = 919
integer height = 92
integer taborder = 330
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Update PD Committees"
end type

event clicked;integer res
res = messagebox("This operation:","This utility will add missing facility committees to current appointments.  Used when committees have been added to a facility after the appointments were created.  ~rContinue?",question!,yesno!,2)
if res = 2 then return

//Start Code Change ----09.24.2013 #V14 maha - changed all loop variables from integer to long
long a
long ac
long p
long pc
long c
long cc
long nr
long nc
long li_fac[]
long ll_commid
long ll_rec[]
long ll_prac
Long ll_seq
long comfind
datetime ldt_date

datastore lds_praccomm,lds_facilcomm,lds_praccomm1

lds_praccomm = create datastore
lds_praccomm1 = create datastore
lds_facilcomm = create datastore
lds_praccomm.dataobject = 'd_prac_pd_comm_for_pt'
lds_praccomm1.dataobject = 'd_prac_pd_comm_for_pt'
lds_facilcomm.dataobject = 'd_comm_of_facil_for_pt'
lds_praccomm.settransobject(sqlca)
lds_praccomm1.settransobject(sqlca)
lds_facilcomm.settransobject(sqlca)
dw_pracaffil.settransobject(sqlca)
ac = dw_pracaffil.retrieve()//a list of all active appointments
//Start Code Change ---- 01.23.2006 #211 maha
if ac < 1 then
	messagebox("Retrieve Error","No Appointment data retrieved")
	return
end if
//End Code Change---01.23.2005 

for a = 1 to ac
	ll_rec[a] = dw_pracaffil.getitemnumber(a,"rec_id")
	li_fac[a] = dw_pracaffil.getitemnumber(a,"parent_facility_id")
next

if upperBound(ll_rec) = 0 then
	ll_rec[1] = 0
end if

if upperBound(li_fac) = 0 then
	li_fac[1] = 0
end if

gnv_appeondb.of_startqueue( )
//---------Begin Modified by (Appeon)Stephen 01.27.2016 for V15.1-Additional TDL type of Recruitment Task--------
//lds_praccomm.retrieve(ll_rec)
lds_praccomm.retrieve()
//---------End Modfiied ------------------------------------------------------
lds_facilcomm.retrieve(li_fac)

gnv_appeondb.of_commitqueue( )

for a = 1 to ac
	ll_prac = dw_pracaffil.getitemnumber(a,"prac_id")
	ll_seq = dw_pracaffil.getitemnumber(a,"seq_no")
	ldt_date = dw_pracaffil.getitemdatetime(a,"apptmnt_start_date")
	lds_praccomm.setfilter('rec_id = '+string(ll_rec[a]))
	lds_praccomm.filter( )
	pc = lds_praccomm.rowcount( )
	lds_facilcomm.setfilter('facility_id = ' + string(li_fac[a]))
	lds_facilcomm.filter( )
	cc = lds_facilcomm.rowcount( )
	for c = 1 to cc
		comfind = 0
		//messagebox("cc",cc)
		ll_commid = lds_facilcomm.getitemnumber(c,"committee_id")
		for p = 1 to pc
			if ll_commid = lds_praccomm.getitemnumber(p,"committee_id") then 
				comfind = 1
			end if
		next
			if comfind = 0 then
				nr = lds_praccomm1.insertrow(0)
				lds_praccomm1.setitem(nr,"rec_id",ll_rec[a])
				lds_praccomm1.setitem(nr,"prac_id",ll_prac)
				lds_praccomm1.setitem(nr,"facility_id",li_fac[a])
				lds_praccomm1.setitem(nr,"seq_no",ll_seq)
				lds_praccomm1.setitem(nr,"committee_id",ll_commid)
				lds_praccomm1.setitem(nr,"active_status",1)
				lds_praccomm1.setitem(nr,"date_sent_for_review", ldt_date )
				lds_praccomm1.setitem(nr,"date_back_from_review", ldt_date )
				if not isnull(ldt_date) then
					lds_praccomm1.setitem(nr,"review_results", 615 )//approved	
				end if
			end if
	next
	//---------Begin Added by (Appeon)Stephen 01.27.2016 for Case # 00061391: Update PD Committees Utility is Not Inserting the Additional Committees--------
	if lds_praccomm1.rowcount() > 500 then
		gnv_appeondb.of_startqueue( )

		lds_praccomm1.update()
		commit using sqlca;
		
		gnv_appeondb.of_commitqueue( )
		lds_praccomm1.reset()
	end if
	//---------End Added ------------------------------------------------------
next			

gnv_appeondb.of_startqueue( )

lds_praccomm1.update()
commit using sqlca;

gnv_appeondb.of_commitqueue( )

destroy lds_praccomm
destroy lds_praccomm1
destroy lds_facilcomm
//---------------------------- APPEON END ----------------------------

messagebox("Done"," Update Completed")






end event

type cb_1 from commandbutton within w_utilities5
integer x = 2427
integer y = 20
integer width = 265
integer height = 84
integer taborder = 590
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "&About"
end type

event clicked;messagebox("To operate this program :","Click the button for the utility you wish to run. ~rSupport functions are intended for IntelliSoft technical support only.")

end event

type dw_facilcomm from datawindow within w_utilities5
boolean visible = false
integer x = 3214
integer y = 1196
integer width = 82
integer height = 64
string dataobject = "d_comm_of_facil"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type dw_praccomm from datawindow within w_utilities5
boolean visible = false
integer x = 3127
integer y = 724
integer width = 279
integer height = 64
string dataobject = "d_prac_pd_comm"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type dw_pracaffil from datawindow within w_utilities5
boolean visible = false
integer x = 3109
integer y = 1020
integer width = 498
integer height = 92
string dataobject = "d_affil_stat_of_prac_all"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type gb_adm from groupbox within w_utilities5
integer x = 18
integer y = 124
integer width = 978
integer height = 2356
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 8388608
long backcolor = 33551856
string text = "Administrative"
end type

type gb_2 from groupbox within w_utilities5
integer x = 1019
integer y = 120
integer width = 978
integer height = 268
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 8388608
long backcolor = 33551856
string text = "Downloads"
end type

type dw_dvfieldcopy from datawindow within w_utilities5
boolean visible = false
integer x = 3173
integer y = 460
integer width = 261
integer height = 76
string dataobject = "d_dvf_field_copy"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type dw_data_view_list from datawindow within w_utilities5
boolean visible = false
integer x = 3186
integer y = 564
integer width = 283
integer height = 76
string dataobject = "d_data_view_list"
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

type gb_3 from groupbox within w_utilities5
integer x = 1015
integer y = 548
integer width = 987
integer height = 1932
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 8388608
long backcolor = 33551856
string text = "Data Clean Up"
end type

type gb_4 from groupbox within w_utilities5
integer x = 2016
integer y = 120
integer width = 965
integer height = 2360
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 8388608
long backcolor = 33551856
string text = "Program Utilities"
end type

type cb_settings from commandbutton within w_utilities5
integer x = 69
integer y = 2368
integer width = 896
integer height = 92
integer taborder = 430
boolean bringtotop = true
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Application Settings"
end type

event clicked;//---------Begin Modified by (Appeon)Harry 06.13.2013 for V141 ISG-CLX--------
//open(w_icred_settings)
//	//close(parent)
if of_get_app_setting("set_9", "I") = 4 then 
	open(w_ctx_settings)
else
	open(w_icred_settings)
end if
//---------End Modfiied ------------------------------------------------------

	




end event

type cb_mod_prf_scr from commandbutton within w_utilities5
boolean visible = false
integer x = 1047
integer y = 2028
integer width = 905
integer height = 100
integer taborder = 190
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
boolean enabled = false
string text = "Modify Screen for Profile Report"
boolean flatstyle = true
end type

event clicked;Open(w_mod_prf_scr_dw)
end event

type cb_clientsetting from commandbutton within w_utilities5
boolean visible = false
integer x = 69
integer y = 1056
integer width = 896
integer height = 92
integer taborder = 140
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Client Settings"
end type

event clicked;Open(w_client_setting)


end event

type cb_old from commandbutton within w_utilities5
integer x = 1047
integer y = 2364
integer width = 919
integer height = 100
integer taborder = 390
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string text = "Legacy Utilities"
end type

event clicked;open(w_utilities_old)
end event

type cb_image_migrate from commandbutton within w_utilities5
boolean visible = false
integer x = 2030
integer y = 2124
integer width = 919
integer height = 92
integer taborder = 440
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
boolean enabled = false
string text = "Migrate Images to DB"
boolean flatstyle = true
end type

event clicked;open(w_image_to_db_conversion_utility)
end event

type gb_hide from groupbox within w_utilities5
integer x = 4146
integer y = 496
integer width = 974
integer height = 680
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
end type

