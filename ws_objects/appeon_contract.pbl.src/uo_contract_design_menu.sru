$PBExportHeader$uo_contract_design_menu.sru
forward
global type uo_contract_design_menu from u_base
end type
type st_gridtip from statictext within uo_contract_design_menu
end type
type pb_show from statictext within uo_contract_design_menu
end type
type pb_gridrectangle from picturebutton within uo_contract_design_menu
end type
type pb_rectangle from picturebutton within uo_contract_design_menu
end type
type pb_gridline from picturebutton within uo_contract_design_menu
end type
type pb_gridtext from picturebutton within uo_contract_design_menu
end type
type pb_gridcompute from picturebutton within uo_contract_design_menu
end type
type pb_gridcolumn from picturebutton within uo_contract_design_menu
end type
type p_alignleft from p_toolbar_pushbutton within uo_contract_design_menu
end type
type p_aligntop from p_toolbar_pushbutton within uo_contract_design_menu
end type
type p_sameheight from p_toolbar_pushbutton within uo_contract_design_menu
end type
type p_samewidth from p_toolbar_pushbutton within uo_contract_design_menu
end type
type pb_delete from picturebutton within uo_contract_design_menu
end type
type pb_sort from picturebutton within uo_contract_design_menu
end type
type pb_picture from picturebutton within uo_contract_design_menu
end type
type pb_oval from picturebutton within uo_contract_design_menu
end type
type pb_groupbox from picturebutton within uo_contract_design_menu
end type
type p_aligntop_1 from picture within uo_contract_design_menu
end type
type p_copysize from picture within uo_contract_design_menu
end type
type st_11 from statictext within uo_contract_design_menu
end type
type st_xy from statictext within uo_contract_design_menu
end type
type st_object_name from statictext within uo_contract_design_menu
end type
type st_10 from statictext within uo_contract_design_menu
end type
type st_9 from statictext within uo_contract_design_menu
end type
type st_8 from statictext within uo_contract_design_menu
end type
type st_6 from statictext within uo_contract_design_menu
end type
type st_underline from statictext within uo_contract_design_menu
end type
type st_italic from statictext within uo_contract_design_menu
end type
type st_bold from statictext within uo_contract_design_menu
end type
type st_right from statictext within uo_contract_design_menu
end type
type st_center from statictext within uo_contract_design_menu
end type
type st_left from statictext within uo_contract_design_menu
end type
type st_relocate_field from statictext within uo_contract_design_menu
end type
type dw_1 from datawindow within uo_contract_design_menu
end type
type r_6 from rectangle within uo_contract_design_menu
end type
type r_1 from rectangle within uo_contract_design_menu
end type
type r_2 from rectangle within uo_contract_design_menu
end type
type r_3 from rectangle within uo_contract_design_menu
end type
type r_4 from rectangle within uo_contract_design_menu
end type
type p_1 from picture within uo_contract_design_menu
end type
type p_alignleft_1 from picture within uo_contract_design_menu
end type
type st_7 from statictext within uo_contract_design_menu
end type
type st_tab_order from statictext within uo_contract_design_menu
end type
type st_copysize from statictext within uo_contract_design_menu
end type
type st_aligntop from statictext within uo_contract_design_menu
end type
type st_12 from statictext within uo_contract_design_menu
end type
type st_alignleft from statictext within uo_contract_design_menu
end type
type r_5 from rectangle within uo_contract_design_menu
end type
type pb_column from picturebutton within uo_contract_design_menu
end type
type pb_text from picturebutton within uo_contract_design_menu
end type
type pb_compute from picturebutton within uo_contract_design_menu
end type
type st_3 from statictext within uo_contract_design_menu
end type
type st_4 from statictext within uo_contract_design_menu
end type
type hsb_1 from hscrollbar within uo_contract_design_menu
end type
type hsb_2 from hscrollbar within uo_contract_design_menu
end type
type p_bold from p_toolbar_button within uo_contract_design_menu
end type
type p_italic from p_toolbar_button within uo_contract_design_menu
end type
type p_underline from p_toolbar_button within uo_contract_design_menu
end type
type p_left from p_toolbar_button within uo_contract_design_menu
end type
type p_center from p_toolbar_button within uo_contract_design_menu
end type
type p_right from p_toolbar_button within uo_contract_design_menu
end type
type st_show_invisible from statictext within uo_contract_design_menu
end type
type pb_gridoval from picturebutton within uo_contract_design_menu
end type
type pb_gridpicture from picturebutton within uo_contract_design_menu
end type
type pb_line from picturebutton within uo_contract_design_menu
end type
end forward

global type uo_contract_design_menu from u_base
integer width = 4320
integer height = 272
long backcolor = 33551856
event ue_mousemove pbm_mousemove
st_gridtip st_gridtip
pb_show pb_show
pb_gridrectangle pb_gridrectangle
pb_rectangle pb_rectangle
pb_gridline pb_gridline
pb_gridtext pb_gridtext
pb_gridcompute pb_gridcompute
pb_gridcolumn pb_gridcolumn
p_alignleft p_alignleft
p_aligntop p_aligntop
p_sameheight p_sameheight
p_samewidth p_samewidth
pb_delete pb_delete
pb_sort pb_sort
pb_picture pb_picture
pb_oval pb_oval
pb_groupbox pb_groupbox
p_aligntop_1 p_aligntop_1
p_copysize p_copysize
st_11 st_11
st_xy st_xy
st_object_name st_object_name
st_10 st_10
st_9 st_9
st_8 st_8
st_6 st_6
st_underline st_underline
st_italic st_italic
st_bold st_bold
st_right st_right
st_center st_center
st_left st_left
st_relocate_field st_relocate_field
dw_1 dw_1
r_6 r_6
r_1 r_1
r_2 r_2
r_3 r_3
r_4 r_4
p_1 p_1
p_alignleft_1 p_alignleft_1
st_7 st_7
st_tab_order st_tab_order
st_copysize st_copysize
st_aligntop st_aligntop
st_12 st_12
st_alignleft st_alignleft
r_5 r_5
pb_column pb_column
pb_text pb_text
pb_compute pb_compute
st_3 st_3
st_4 st_4
hsb_1 hsb_1
hsb_2 hsb_2
p_bold p_bold
p_italic p_italic
p_underline p_underline
p_left p_left
p_center p_center
p_right p_right
st_show_invisible st_show_invisible
pb_gridoval pb_gridoval
pb_gridpicture pb_gridpicture
pb_line pb_line
end type
global uo_contract_design_menu uo_contract_design_menu

type variables
pfc_cst_u_contract_data_design inv_data_design

String	is_CurObj
Boolean	ib_HasModify, ib_ModifyText


end variables

forward prototypes
public subroutine of_setobjectenable (boolean ab_enable)
public function integer of_set_parentobject (pfc_cst_u_contract_data_design anv_data_design)
public subroutine of_alignselobjs (long al_align)
public subroutine of_modifyselobjsattr (string as_proexp)
public subroutine of_synchronization_toolbar (string as_barname)
public function integer of_messagebox (string as_message)
public subroutine of_synchronization_text (string as_text)
end prototypes

event ue_mousemove;//====================================================================
// Event: ue_MouseMove()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    unsignedlong    flags
// 	value    integer         xpos
// 	value    integer         ypos
//--------------------------------------------------------------------
// Returns:  long
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2010-05-06
//--------------------------------------------------------------------
//	Copyright (c) 1999-2010 ContractLogix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

p_Bold.Event ue_MouseAway()
p_Italic.Event ue_MouseAway()
p_UnderLine.Event ue_MouseAway()
p_Left.Event ue_MouseAway()
p_Center.Event ue_MouseAway()
p_Right.Event ue_MouseAway()

p_SameWidth.Event ue_MouseAway()
p_SameHeight.Event ue_MouseAway()
p_AlignTop.Event ue_MouseAway()
p_AlignLeft.Event ue_MouseAway()

end event

public subroutine of_setobjectenable (boolean ab_enable);int li_count,li_i
statictext lst_object
picture lp_object
hscrollbar lhs_object

li_count = upperbound(this.control)

for li_i = 1 to li_count
	if this.control[li_i].typeof() = statictext! then
		lst_object = this.control[li_i]
		lst_object.enabled = ab_enable
	elseif this.control[li_i].typeof() = picture! then
		lp_object = this.control[li_i]
		lp_object.enabled = ab_enable
//	elseif this.control[li_i].typeof() = hscrollbar! then
//		lhs_object = this.control[li_i]
//		lhs_object.visible = ab_enable
	end if
next
end subroutine

public function integer of_set_parentobject (pfc_cst_u_contract_data_design anv_data_design);//add by gavin on 2009-03-04
inv_data_design = anv_data_design
return 1
end function

public subroutine of_alignselobjs (long al_align);//====================================================================
// Function: of_AlignSelObjs()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    long    al_Align
//--------------------------------------------------------------------
// Returns:  (none)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-04-14
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Appeon, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

Long		ll_Cycle,ll_TotalCnts,ll_SelObjCnts
String	ls_ObjName,ls_Modify,ls_Type,ls_Field_id

if IsValid(inv_data_design) then
	ll_SelObjCnts = inv_data_design.of_GetSelectedObjectCnts()
	if ll_SelObjCnts <= 0 then Return
	
	ll_TotalCnts = UpperBound(inv_data_design.istr_SelectObj)
	for ll_Cycle = 1 to ll_TotalCnts
		ls_ObjName = inv_data_design.istr_SelectObj[ll_Cycle].FName
		if Not IsNull(ls_ObjName) and ls_ObjName <> '' then
			ls_Modify = ls_ObjName + ".alignment = '" + String(al_Align) + "'"
			inv_data_design.istr_SelectObj[ll_Cycle].FBand.Modify(ls_Modify)
			inv_data_design.Event ue_Setmodify(ls_Modify)
			
			ls_Type = inv_Data_Design.of_GetSelectedObjectType(ls_ObjName)
			if ls_Type = "column" or ls_Type = "text" and Left(lower(ls_ObjName),Len("object")) <> "object" then
				if ls_Type = "column" then
					ls_Field_id = inv_Data_Design.of_GetSelectedObjectID(ls_ObjName)
				else
					if Right(ls_ObjName, 2) = "_t" then
						ls_Field_id = inv_Data_Design.of_GetSelectedObjectTag(ls_ObjName)
					end if
				end if
				
				if IsNull(ls_Field_id) or Trim(ls_Field_id) = "" or ls_Field_id = '!' or ls_Field_id = '?' or Not IsNumber(ls_Field_id) then Continue
				
				inv_Data_Design.dw_Properties.SetFilter("data_view_fields_field_id = " + ls_Field_id)
				inv_Data_Design.dw_Properties.Filter()
				if inv_Data_Design.dw_Properties.RowCount() <= 0 Then Continue
				
				if ls_Type = "column" then
					inv_data_design.dw_properties.SetItem(1,"data_view_fields_justification",al_Align)
				else
					inv_data_design.dw_properties.SetItem(1,"data_view_fields_label_justification",al_Align)
				end if
				inv_data_design.dw_properties.AcceptText()
			end if
		end if
	next
end if

end subroutine

public subroutine of_modifyselobjsattr (string as_proexp);//====================================================================
// Function: of_ModifySelObjsAttr()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    string    as_ProExp
//--------------------------------------------------------------------
// Returns:  (none)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-04-14
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Appeon, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

Long		ll_Cycle,ll_TotalCnts,ll_SelObjCnts
String	ls_ObjName,ls_Modify

as_ProExp = Trim(as_ProExp)
if Left(as_ProExp,1) <> "." then as_ProExp = "." + as_ProExp

if IsValid(inv_data_design) then
	ll_SelObjCnts = inv_data_design.of_GetSelectedObjectCnts()
	if ll_SelObjCnts <= 0 then Return
	
	ll_TotalCnts = UpperBound(inv_data_design.istr_SelectObj)
	for ll_Cycle = 1 to ll_TotalCnts
		ls_ObjName = inv_data_design.istr_SelectObj[ll_Cycle].FName
		if Not IsNull(ls_ObjName) and ls_ObjName <> '' then
			ls_Modify = ls_ObjName + as_ProExp
			inv_data_design.istr_SelectObj[ll_Cycle].FBand.Modify(ls_Modify)
			inv_data_design.Event ue_Setmodify(ls_Modify)
		end if
	next
end if

end subroutine

public subroutine of_synchronization_toolbar (string as_barname);// synchronization bar


Choose Case  as_barname
	Case 'bold'
		p_bold.Event ue_lbuttondown( 0, 0, 0 )
	Case 'italic'
		p_italic.Event ue_lbuttondown( 0, 0, 0 )		
		
	Case 'underline'
		p_underline.Event ue_lbuttondown( 0, 0, 0 )
		
	Case 'left', '0'
		p_left.Event ue_lbuttondown( 0, 0, 0 )		
		
	Case 'center', '2'
		p_center.Event ue_lbuttondown( 0, 0, 0 )		
	Case 'right', '1'
		p_right.Event ue_lbuttondown( 0, 0, 0 )	
End Choose
end subroutine

public function integer of_messagebox (string as_message);If pb_show.borderstyle = stylelowered! Then
	MessageBox( 'Tips', 'You cannot design when you use Show Invisible in Grid style.' )
	Return -1
End If
Return 0
end function

public subroutine of_synchronization_text (string as_text);If dw_1.GetRow( ) > 0 And Not ib_ModifyText  Then dw_1.SetItem( dw_1.GetRow( ), 'label', as_Text )
end subroutine

on uo_contract_design_menu.create
int iCurrent
call super::create
this.st_gridtip=create st_gridtip
this.pb_show=create pb_show
this.pb_gridrectangle=create pb_gridrectangle
this.pb_rectangle=create pb_rectangle
this.pb_gridline=create pb_gridline
this.pb_gridtext=create pb_gridtext
this.pb_gridcompute=create pb_gridcompute
this.pb_gridcolumn=create pb_gridcolumn
this.p_alignleft=create p_alignleft
this.p_aligntop=create p_aligntop
this.p_sameheight=create p_sameheight
this.p_samewidth=create p_samewidth
this.pb_delete=create pb_delete
this.pb_sort=create pb_sort
this.pb_picture=create pb_picture
this.pb_oval=create pb_oval
this.pb_groupbox=create pb_groupbox
this.p_aligntop_1=create p_aligntop_1
this.p_copysize=create p_copysize
this.st_11=create st_11
this.st_xy=create st_xy
this.st_object_name=create st_object_name
this.st_10=create st_10
this.st_9=create st_9
this.st_8=create st_8
this.st_6=create st_6
this.st_underline=create st_underline
this.st_italic=create st_italic
this.st_bold=create st_bold
this.st_right=create st_right
this.st_center=create st_center
this.st_left=create st_left
this.st_relocate_field=create st_relocate_field
this.dw_1=create dw_1
this.r_6=create r_6
this.r_1=create r_1
this.r_2=create r_2
this.r_3=create r_3
this.r_4=create r_4
this.p_1=create p_1
this.p_alignleft_1=create p_alignleft_1
this.st_7=create st_7
this.st_tab_order=create st_tab_order
this.st_copysize=create st_copysize
this.st_aligntop=create st_aligntop
this.st_12=create st_12
this.st_alignleft=create st_alignleft
this.r_5=create r_5
this.pb_column=create pb_column
this.pb_text=create pb_text
this.pb_compute=create pb_compute
this.st_3=create st_3
this.st_4=create st_4
this.hsb_1=create hsb_1
this.hsb_2=create hsb_2
this.p_bold=create p_bold
this.p_italic=create p_italic
this.p_underline=create p_underline
this.p_left=create p_left
this.p_center=create p_center
this.p_right=create p_right
this.st_show_invisible=create st_show_invisible
this.pb_gridoval=create pb_gridoval
this.pb_gridpicture=create pb_gridpicture
this.pb_line=create pb_line
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.st_gridtip
this.Control[iCurrent+2]=this.pb_show
this.Control[iCurrent+3]=this.pb_gridrectangle
this.Control[iCurrent+4]=this.pb_rectangle
this.Control[iCurrent+5]=this.pb_gridline
this.Control[iCurrent+6]=this.pb_gridtext
this.Control[iCurrent+7]=this.pb_gridcompute
this.Control[iCurrent+8]=this.pb_gridcolumn
this.Control[iCurrent+9]=this.p_alignleft
this.Control[iCurrent+10]=this.p_aligntop
this.Control[iCurrent+11]=this.p_sameheight
this.Control[iCurrent+12]=this.p_samewidth
this.Control[iCurrent+13]=this.pb_delete
this.Control[iCurrent+14]=this.pb_sort
this.Control[iCurrent+15]=this.pb_picture
this.Control[iCurrent+16]=this.pb_oval
this.Control[iCurrent+17]=this.pb_groupbox
this.Control[iCurrent+18]=this.p_aligntop_1
this.Control[iCurrent+19]=this.p_copysize
this.Control[iCurrent+20]=this.st_11
this.Control[iCurrent+21]=this.st_xy
this.Control[iCurrent+22]=this.st_object_name
this.Control[iCurrent+23]=this.st_10
this.Control[iCurrent+24]=this.st_9
this.Control[iCurrent+25]=this.st_8
this.Control[iCurrent+26]=this.st_6
this.Control[iCurrent+27]=this.st_underline
this.Control[iCurrent+28]=this.st_italic
this.Control[iCurrent+29]=this.st_bold
this.Control[iCurrent+30]=this.st_right
this.Control[iCurrent+31]=this.st_center
this.Control[iCurrent+32]=this.st_left
this.Control[iCurrent+33]=this.st_relocate_field
this.Control[iCurrent+34]=this.dw_1
this.Control[iCurrent+35]=this.r_6
this.Control[iCurrent+36]=this.r_1
this.Control[iCurrent+37]=this.r_2
this.Control[iCurrent+38]=this.r_3
this.Control[iCurrent+39]=this.r_4
this.Control[iCurrent+40]=this.p_1
this.Control[iCurrent+41]=this.p_alignleft_1
this.Control[iCurrent+42]=this.st_7
this.Control[iCurrent+43]=this.st_tab_order
this.Control[iCurrent+44]=this.st_copysize
this.Control[iCurrent+45]=this.st_aligntop
this.Control[iCurrent+46]=this.st_12
this.Control[iCurrent+47]=this.st_alignleft
this.Control[iCurrent+48]=this.r_5
this.Control[iCurrent+49]=this.pb_column
this.Control[iCurrent+50]=this.pb_text
this.Control[iCurrent+51]=this.pb_compute
this.Control[iCurrent+52]=this.st_3
this.Control[iCurrent+53]=this.st_4
this.Control[iCurrent+54]=this.hsb_1
this.Control[iCurrent+55]=this.hsb_2
this.Control[iCurrent+56]=this.p_bold
this.Control[iCurrent+57]=this.p_italic
this.Control[iCurrent+58]=this.p_underline
this.Control[iCurrent+59]=this.p_left
this.Control[iCurrent+60]=this.p_center
this.Control[iCurrent+61]=this.p_right
this.Control[iCurrent+62]=this.st_show_invisible
this.Control[iCurrent+63]=this.pb_gridoval
this.Control[iCurrent+64]=this.pb_gridpicture
this.Control[iCurrent+65]=this.pb_line
end on

on uo_contract_design_menu.destroy
call super::destroy
destroy(this.st_gridtip)
destroy(this.pb_show)
destroy(this.pb_gridrectangle)
destroy(this.pb_rectangle)
destroy(this.pb_gridline)
destroy(this.pb_gridtext)
destroy(this.pb_gridcompute)
destroy(this.pb_gridcolumn)
destroy(this.p_alignleft)
destroy(this.p_aligntop)
destroy(this.p_sameheight)
destroy(this.p_samewidth)
destroy(this.pb_delete)
destroy(this.pb_sort)
destroy(this.pb_picture)
destroy(this.pb_oval)
destroy(this.pb_groupbox)
destroy(this.p_aligntop_1)
destroy(this.p_copysize)
destroy(this.st_11)
destroy(this.st_xy)
destroy(this.st_object_name)
destroy(this.st_10)
destroy(this.st_9)
destroy(this.st_8)
destroy(this.st_6)
destroy(this.st_underline)
destroy(this.st_italic)
destroy(this.st_bold)
destroy(this.st_right)
destroy(this.st_center)
destroy(this.st_left)
destroy(this.st_relocate_field)
destroy(this.dw_1)
destroy(this.r_6)
destroy(this.r_1)
destroy(this.r_2)
destroy(this.r_3)
destroy(this.r_4)
destroy(this.p_1)
destroy(this.p_alignleft_1)
destroy(this.st_7)
destroy(this.st_tab_order)
destroy(this.st_copysize)
destroy(this.st_aligntop)
destroy(this.st_12)
destroy(this.st_alignleft)
destroy(this.r_5)
destroy(this.pb_column)
destroy(this.pb_text)
destroy(this.pb_compute)
destroy(this.st_3)
destroy(this.st_4)
destroy(this.hsb_1)
destroy(this.hsb_2)
destroy(this.p_bold)
destroy(this.p_italic)
destroy(this.p_underline)
destroy(this.p_left)
destroy(this.p_center)
destroy(this.p_right)
destroy(this.st_show_invisible)
destroy(this.pb_gridoval)
destroy(this.pb_gridpicture)
destroy(this.pb_line)
end on

type st_gridtip from statictext within uo_contract_design_menu
boolean visible = false
integer x = 3666
integer y = 12
integer width = 640
integer height = 260
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 33551856
string text = "In Grid style you cannot use mouse to move compute, field or text objects in detail or header band."
boolean focusrectangle = false
end type

type pb_show from statictext within uo_contract_design_menu
integer x = 2505
integer y = 80
integer width = 315
integer height = 136
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
string text = "    Show     Invisible"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;IF IsValid(inv_data_design) then
	If inv_data_design.ib_show_invisible Then
		inv_data_design.ib_show_invisible = false
	Else
		inv_data_design.ib_show_invisible = True
	End If
	inv_data_design.of_show_invisible( inv_data_design.ib_show_invisible   )
END IF
this.Border = TRUE 

If  This.BorderStyle = StyleLowered! Then
	This.BorderStyle = StyleRaised!
Else
	This.BorderStyle = StyleLowered!
End If


end event

type pb_gridrectangle from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 1248
integer y = 60
integer width = 105
integer height = 88
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Rectangle!"
vtextalign vtextalign = vcenter!
boolean map3dcolors = true
string powertiptext = "Add Rectangle control"
end type

event clicked;If of_MessageBox( '' ) = -1 Then Return
IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('rectangle')
END IF
end event

type pb_rectangle from picturebutton within uo_contract_design_menu
integer x = 1248
integer y = 60
integer width = 105
integer height = 88
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Rectangle!"
boolean map3dcolors = true
string powertiptext = "Add Rectangle control"
end type

event clicked;IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('rectangle')
END IF
end event

type pb_gridline from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 1129
integer y = 152
integer width = 105
integer height = 88
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Line!"
vtextalign vtextalign = vcenter!
boolean map3dcolors = true
string powertiptext = "Add Line control"
end type

event clicked;
If of_MessageBox( '' ) = -1 Then Return
IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('line')
END IF
end event

type pb_gridtext from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 1129
integer y = 60
integer width = 105
integer height = 88
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "StaticText!"
boolean map3dcolors = true
string powertiptext = "Add Text control"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy
//Integer li_object_no
//long ll_scroll
//long ll_y
//String ls_obj_name
//
//ll_scroll = Long(w_contract_data_design.uo_design.idw_detail.Object.DataWindow.VerticalScrollPosition)
//ll_y = ll_scroll + 20
//
//if w_contract_data_design.triggerevent("pfc_save") < 1 then return -1
//
//FOR li_object_no = 1 TO 1000
//	ls_obj_name = w_contract_data_design.uo_design.idw_detail.Describe("object" + String(li_object_no) + "_t.name")
//	IF ls_obj_name = "object" + String(li_object_no) + "_t" THEN CONTINUE
//
//	w_contract_data_design.uo_design.idw_detail.Modify("create text(band=detail text='text' border='0' color='0' x='20' y='" + string(ll_y) + "' height='52' width='150'  font.face='Segoe UI' font.height='-8' font.weight='400'  font.family='2' font.pitch='2' font.charset='0' background.mode='1' background.color='553648127' name=object" + String(li_object_no) + "_t)"  )
//	EXIT
//NEXT

//modify by gavin on 2009/3/4
//if isValid(w_contract_data_design) then 
//	w_contract_data_design.event ue_new('text')
//end if

If of_MessageBox( '' ) = -1 Then Return

IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('text')
END IF

//---------------------------- APPEON END ----------------------------
end event

type pb_gridcompute from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 1010
integer y = 60
integer width = 105
integer height = 88
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Compute5!"
boolean map3dcolors = true
string powertiptext = "Add Compute control"
end type

event clicked;////<add>      06/21/2007 by: Andy
//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy

////describe : create computer field
//Integer  li_object_no
//long     ll_scroll
//long     ll_y
//String   ls_obj_name,ls_modify,ls_Err
//String   ls_Expression
//str_pass lstr_pass,lstr_Ret
//u_dw     ldw_Temp
//
//ldw_Temp  = w_contract_data_design.uo_design.idw_detail
//ll_scroll = Long(ldw_Temp.Object.DataWindow.VerticalScrollPosition)
//ll_y      = ll_scroll + 20
//
//if w_contract_data_design.triggerevent("pfc_save") < 1 then return -1
////--------------------------- APPEON BEGIN ---------------------------
////$<Modify> 2007-10-29 By: Andy
////$<Reason> compute.name = compute_xx_c
//FOR li_object_no = 1 TO 1000
//	ls_obj_name = ldw_Temp.Describe("compute_" + String(li_object_no) + ".name")
//	IF lower(ls_obj_name) = "compute_" + String(li_object_no) + "_c" THEN CONTINUE
//
//	ls_modify = "create compute(band=detail expression='' border='0' color='0' x='20'" + &
//					" y='" + string(ll_y) + "' height='52' width='520' format='[GENERAL]' name=compute_" + String(li_object_no) + "_c" + " visible='1'" + &
//					" font.face='Segoe UI' font.height='-8' font.weight='400'  font.family='2' font.pitch='2' font.charset='0'" + &
//					" background.mode='1' background.color='536870912' tag='' )"//background.mode='2' background.color='1073741824'
//	ls_Err    = ldw_Temp.Modify(ls_modify)	
//	ls_obj_name   = "compute_" + String(li_object_no) + "_c"
//	ls_Expression = ''
//	EXIT
//NEXT
////---------------------------- APPEON END ----------------------------
//
//lstr_pass.l_facility_id     = -1//-1:screen/else:export
//lstr_pass.s_string          = ls_Expression//expression
//lstr_pass.s_string_array[1] = ls_obj_name//object name
//lstr_pass.s_u_dw            = ldw_Temp//relative dw
//openwithparm(w_export_expression,lstr_pass)
//
//lstr_Ret = message.Powerobjectparm
////canceled
//if Not IsValid(lstr_Ret) or ISNULL(lstr_Ret) THEN 
//	ldw_Temp.Modify("destroy " + ls_obj_name)
//end if
////end of add

//modify by gavin on 2009/3/4

If of_MessageBox( '' ) = -1 Then Return

if isValid(inv_data_design) then 
	inv_data_design.event ue_new('compute')
end if
//---------------------------- APPEON END ----------------------------
end event

type pb_gridcolumn from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 891
integer y = 60
integer width = 105
integer height = 88
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Justify!"
boolean map3dcolors = true
string powertiptext = "Add Field control"
end type

event clicked;//BEGIN---Modify by Scofield on 2010-03-29
If of_MessageBox( '' ) = -1 Then Return

if IsValid(inv_data_design) then
	inv_data_design.Trigger Event ue_AddField()
end if
//END---Modify by Scofield on 2010-03-29

end event

type p_alignleft from p_toolbar_pushbutton within uo_contract_design_menu
integer x = 2345
integer y = 152
boolean originalsize = false
string picturename = "AlignLeft_Normal.jpg"
string powertiptext = "Align left edges to first selected"
end type

event constructor;call super::constructor;of_InitPicture("AlignLeft_Up.jpg","AlignLeft_Normal.jpg","AlignLeft_Down.jpg")

end event

event clicked;call super::clicked;
If of_MessageBox( '' ) = -1 Then Return

if IsValid(inv_data_design) then
	inv_data_design.Event ue_Arrange('snap_to_left')
end if

end event

type p_aligntop from p_toolbar_pushbutton within uo_contract_design_menu
integer x = 2226
integer y = 152
boolean originalsize = false
string picturename = "AlignTop_Normal.jpg"
string powertiptext = "Align top edges to first selected"
end type

event constructor;call super::constructor;of_InitPicture("AlignTop_Up.jpg","AlignTop_Normal.jpg","AlignTop_Down.jpg")

end event

event clicked;call super::clicked;If of_MessageBox( '' ) = -1 Then Return

if IsValid(inv_data_design) then
	inv_data_design.Event ue_Arrange('snap_to_top')
end if

end event

type p_sameheight from p_toolbar_pushbutton within uo_contract_design_menu
integer x = 2345
integer y = 60
boolean originalsize = false
string picturename = "SameHeight_Normal.jpg"
string powertiptext = "Make all heights same as first selected"
end type

event constructor;call super::constructor;of_InitPicture("SameHeight_Up.jpg","SameHeight_Normal.jpg","SameHeight_Down.jpg")

end event

event clicked;call super::clicked;
If of_MessageBox( '' ) = -1 Then Return

if IsValid(inv_data_design) then
	inv_data_design.Event ue_Arrange('same_height')
end if

end event

type p_samewidth from p_toolbar_pushbutton within uo_contract_design_menu
integer x = 2226
integer y = 60
boolean originalsize = false
string picturename = "SameWidth_Normal.jpg"
string powertiptext = "Make all widths same as first selected"
end type

event constructor;call super::constructor;of_InitPicture("SameWidth_Up.jpg","SameWidth_Normal.jpg","SameWidth_Down.jpg")

end event

event clicked;call super::clicked;
If of_MessageBox( '' ) = -1 Then Return

if IsValid(inv_data_design) then
	inv_data_design.Event ue_Arrange('same_width')
end if

end event

type pb_delete from picturebutton within uo_contract_design_menu
integer x = 1440
integer y = 152
integer width = 105
integer height = 88
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Clear!"
boolean map3dcolors = true
string powertiptext = "Delete Object"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy

//Integer li_obj_id
//Integer li_found
//String ls_obj_id
//String ls_Type//<add> 06/21/2007 by: Andy
//
//if upperbound(w_contract_data_design.uo_design.is_last_object) = 0 then return //maha 052005
////<add> 06/21/2007 by: Andy
//ls_Type = w_contract_data_design.uo_design.idw_detail.describe(w_contract_data_design.uo_design.is_last_object[1] + '.type')
//if isnull(ls_Type) then ls_Type = ''
////end of add
//IF Pos(w_contract_data_design.uo_design.is_last_object[1], "object" ) > 0 or &
//	ls_Type = 'compute' THEN//<add> 06/21/2007 by: Andy
//	ls_obj_id = Mid(w_contract_data_design.uo_design.is_last_object[1], 7,100)
//	IF Right( ls_obj_id, 2) = "_t" THEN
//		ls_obj_id = Mid(ls_obj_id, 1, Len(ls_obj_id) -2 )
//	END IF
//	w_contract_data_design.uo_design.idw_detail.Modify("destroy " + w_contract_data_design.uo_design.is_last_object[1] )
//ELSE
//	//MessageBox("Clear Error", "You can't delete field or field label objects.  To hide, make the Visible property in the propeties dialog box = No.")
//	MessageBox("Clear Error", "You can't delete field or field label objects.  To hide these objects, set the Visible property in the properties dialog box to No.")
//END IF

//modify by gavin on 2009/3/4
If of_MessageBox( '' ) = -1 Then Return

IF IsValid(inv_data_design) then 
	inv_data_design.event ue_modify('delete')
END IF


//---------------------------- APPEON END ----------------------------
end event

type pb_sort from picturebutton within uo_contract_design_menu
integer x = 1577
integer y = 152
integer width = 105
integer height = 88
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Sort!"
boolean map3dcolors = true
string powertiptext = "Sort"
end type

event clicked;//start--modify by gavin on 2009-03-04
//if isvalid(w_contract_data_design) then
//	w_contract_data_design.uo_design.Triggerevent('pfc_cst_sort')
//end if
If of_MessageBox( '' ) = -1 Then Return

IF IsValid(inv_data_design) then
	inv_data_design.Triggerevent('pfc_cst_sort')
END IF
//End--modify by gavin on 2009-03-04
end event

type pb_picture from picturebutton within uo_contract_design_menu
integer x = 1248
integer y = 152
integer width = 105
integer height = 88
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Picture5!"
boolean map3dcolors = true
string powertiptext = "Add Picture control"
end type

event clicked;//Create Picture Control - jervis 11.20.2009
IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('picture')
END IF

end event

type pb_oval from picturebutton within uo_contract_design_menu
integer x = 1010
integer y = 152
integer width = 105
integer height = 88
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Oval!"
boolean map3dcolors = true
string powertiptext = "Add Oval control"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$< Add  > 2009-03-02 By: Scofield
//$<Reason> Create a new oval.

//if IsValid(w_contract_data_design) then 
//	w_contract_data_design.event ue_new("oval")
//end if

IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('oval')
END IF

//---------------------------- APPEON END ----------------------------

end event

type pb_groupbox from picturebutton within uo_contract_design_menu
integer x = 891
integer y = 152
integer width = 105
integer height = 88
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "GroupBox!"
boolean map3dcolors = true
string powertiptext = "Add Groupbox control"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy

//Integer li_object_no
//String ls_obj_name
//
//FOR li_object_no = 1 TO 1000
//	ls_obj_name = w_contract_data_design.uo_design.idw_detail.Describe("object" + String(li_object_no) + ".name")
//	IF ls_obj_name = "object" + String(li_object_no) THEN CONTINUE
//
//	w_contract_data_design.uo_design.idw_detail.Modify("create groupbox(band=detail text='none'border='5' color='128' x='20' y='20' height='390' width='660'  font.face='Segoe UI' font.height='-8' font.weight='400'  font.family='2' font.pitch='2' font.charset='0' background.mode='1' background.color='553648127' name=object" + String(li_object_no) +")" )
//	EXIT
//NEXT

//modify by gavin on 2009/3/4
//if isValid(w_contract_data_design) then 
//	w_contract_data_design.event ue_new("groupbox")
//end if

If of_MessageBox( '' ) = -1 Then Return

IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('groupbox')
END IF
//---------------------------- APPEON END ----------------------------

end event

type p_aligntop_1 from picture within uo_contract_design_menu
integer x = 2473
integer y = 436
integer width = 73
integer height = 64
boolean originalsize = true
string picturename = "AlignTop!"
boolean focusrectangle = false
boolean map3dcolors = true
end type

event clicked;if IsValid(inv_data_design) then
	inv_data_design.event ue_arrange('snap_to_top')
end if

end event

type p_copysize from picture within uo_contract_design_menu
integer x = 2473
integer y = 336
integer width = 73
integer height = 64
boolean originalsize = true
string picturename = "SizeHorizontal!"
boolean focusrectangle = false
boolean map3dcolors = true
end type

event clicked;if IsValid(inv_data_design) then
	inv_data_design.event ue_arrange('same_width')
end if

end event

type st_11 from statictext within uo_contract_design_menu
integer x = 2889
integer y = 4
integer width = 274
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Object Info"
boolean focusrectangle = false
end type

type st_xy from statictext within uo_contract_design_menu
integer x = 2853
integer y = 140
integer width = 773
integer height = 108
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 33551856
boolean enabled = false
boolean focusrectangle = false
end type

type st_object_name from statictext within uo_contract_design_menu
integer x = 2853
integer y = 64
integer width = 763
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 33551856
boolean enabled = false
boolean focusrectangle = false
end type

type st_10 from statictext within uo_contract_design_menu
integer x = 46
integer y = 4
integer width = 247
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Label Text"
boolean focusrectangle = false
end type

type st_9 from statictext within uo_contract_design_menu
integer x = 2231
integer y = 4
integer width = 233
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Size/Align"
boolean focusrectangle = false
end type

type st_8 from statictext within uo_contract_design_menu
integer x = 1769
integer y = 4
integer width = 361
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Text Properties"
boolean focusrectangle = false
end type

type st_6 from statictext within uo_contract_design_menu
integer x = 1518
integer y = 4
integer width = 96
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Edit"
boolean focusrectangle = false
end type

type st_underline from statictext within uo_contract_design_menu
integer x = 2263
integer y = 324
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
boolean underline = true
long textcolor = 33554432
long backcolor = 67108864
string text = "U"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;//====================================================================
// Event: clicked()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  long
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-04-15
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Appeon, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

String   ls_ObjName,ls_ColName,ls_Type,ls_Modify,ls_Syntax,ls_Err,ls_Field_id,ls_EditStyle
long		ll_Cycle,ll_TotalCnts,ll_SelObjCnts,ll_Rtn

ll_SelObjCnts = inv_Data_Design.of_GetSelectedObjectCnts()
if ll_SelObjCnts <= 0 then Return
	
if This.BorderStyle = StyleLowered! then
	This.BorderStyle = StyleRaised!
	ls_Syntax = ".font.underline='0'"
else
	This.BorderStyle = StyleLowered!
	ls_Syntax = ".font.underline='1'"
end if

ll_TotalCnts = UpperBound(inv_Data_Design.istr_SelectObj)
for ll_Cycle = 1 to ll_TotalCnts
	ls_ObjName = inv_Data_Design.istr_SelectObj[ll_Cycle].FName
	if IsNull(ls_ObjName) or ls_ObjName = '' then Continue
	
	ls_Type = inv_Data_Design.of_GetSelectedObjectType(ls_ObjName)
	if ls_Type <> "text" and ls_Type <> "compute" and ls_Type <> "column" then Continue
	
	if ls_Type = "text" and Right(ls_ObjName,2) = "_t" then
		ls_ColName = inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Describe(Left(ls_ObjName,Len(ls_ObjName) - 2) + ".Name")
	end if
	
	if ls_Type = 'compute' or ls_ColName = "?" or ls_ColName = "!" then
		inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Modify(ls_ObjName + ls_Syntax)
		inv_Data_Design.Event ue_SetModify(ls_ObjName + ls_Syntax)
	else
		if ll_Rtn <> 0 and ll_Rtn <> 1 then Continue
		
		if Lower(ls_Type) = "column" then
			ls_Field_id = inv_Data_Design.of_GetSelectedObjectID(ls_ObjName)
			ls_ColName = ls_ObjName
		else
			if Right(ls_ObjName, 2) = "_t" then
				ls_Field_id = inv_Data_Design.of_GetSelectedObjectTag(ls_ObjName)
				ls_ColName = Left(ls_ObjName,Len(ls_ObjName) - 2)
			end if
		end if
		
		if IsNull(ls_Field_id) or Trim(ls_Field_id) = "" or ls_Field_id = '!' or ls_Field_id = '?' or Not IsNumber(ls_Field_id) then Continue
		
		inv_Data_Design.dw_Properties.SetFilter("data_view_fields_field_id = " + ls_Field_id)
		inv_Data_Design.dw_Properties.Filter()
		if inv_Data_Design.dw_Properties.RowCount() <= 0 Then Continue
		
		ls_EditStyle = inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Describe(ls_ColName + ".Edit.Style")
		
		if This.BorderStyle = StyleLowered! then
			if ll_Rtn <> 1 and inv_Data_Design.is_Open_Style = 'screen' then
				ll_Rtn = MessageBox("Underline Format","Only required fields are underlined.  Would you like to make this a required field?", Question!,YesNo!,1)
				if ll_Rtn <> 1 then Continue
			end if
			inv_Data_Design.dw_Properties.SetItem(1,"data_view_fields_required",'Y')
			ls_Modify  = " " + ls_ColName + "." + ls_EditStyle + ".Required = 'Yes'"
		else
			inv_Data_Design.dw_Properties.SetItem(1,"data_view_fields_required",'N')
			ls_Modify  = " " + ls_ColName + "." + ls_EditStyle + ".Required = 'No'"
		end if
		
		ls_Modify += " " + ls_ColName + "_t" + ls_Syntax
		
		inv_Data_Design.dw_Properties.Accepttext()
		inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Modify(ls_Modify)
		inv_Data_Design.Event ue_SetModify(ls_Modify)
	end if
next

end event

type st_italic from statictext within uo_contract_design_menu
integer x = 2144
integer y = 324
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
boolean italic = true
long textcolor = 33554432
long backcolor = 67108864
string text = "I"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;//====================================================================
// Event: clicked()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  long
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-04-14
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Appeon, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

String ls_ProExp

if This.BorderStyle = StyleLowered! then
	This.BorderStyle = StyleRaised!
	ls_ProExp = ".font.italic='0'"
else
	This.BorderStyle = StyleLowered!
	ls_ProExp = ".font.italic='1'"
end if

of_ModifySelObjsAttr(ls_ProExp)

end event

type st_bold from statictext within uo_contract_design_menu
integer x = 2025
integer y = 324
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 79741120
string text = "B"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;String ls_ProExp

if This.BorderStyle = StyleLowered! then
	This.BorderStyle = StyleRaised!
	ls_ProExp = ".font.weight='400'"
else
	This.BorderStyle = StyleLowered!
	ls_ProExp = ".font.weight='700'"
end if

of_ModifySelObjsAttr(ls_ProExp)

end event

type st_right from statictext within uo_contract_design_menu
event lbuttondown pbm_lbuttondown
integer x = 2263
integer y = 424
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
string text = "R"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

type st_center from statictext within uo_contract_design_menu
event lbuttondown pbm_lbuttondown
integer x = 2144
integer y = 424
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
string text = "C"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

type st_left from statictext within uo_contract_design_menu
event lbuttondown pbm_lbuttondown
integer x = 2025
integer y = 424
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 79741120
string text = "L"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

type st_relocate_field from statictext within uo_contract_design_menu
boolean visible = false
integer x = 1550
integer width = 357
integer height = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
string text = "Relocate Field"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;IF This.BorderStyle = StyleLowered! THEN
	This.BorderStyle = StyleRaised!
ELSE
	This.BorderStyle = StyleLowered!
END IF

IF UpperBound(w_contract_data_design.uo_design.is_last_object[]) = 0 THEN
	MessageBox("Error", "You must first select the fields you want to relocate.")
	Return
END IF

w_contract_data_design.uo_design.ib_relocating_fields = True

end event

type dw_1 from datawindow within uo_contract_design_menu
event ue_dwnprocessenter pbm_dwnprocessenter
integer x = 41
integer y = 108
integer width = 768
integer height = 76
integer taborder = 10
boolean bringtotop = true
string dataobject = "d_design_label_editor"
boolean border = false
boolean livescroll = true
end type

event ue_dwnprocessenter;//====================================================================
// Event: ue_dwnProcessEnter()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  long
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-10-16
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 ContractLogix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================
string			ls_TObj

if inv_data_design.is_open_style = "screen" and ( inv_data_design.ii_Screen_id = 6 Or inv_data_design.ii_Screen_id = 7 ) then //added by gavin 20120607
	If inv_data_design.ii_Screen_id = 6 Then
		ls_TObj = 'ccci_' + is_CurObj
	Else
		ls_TObj = 'occi_' + is_CurObj
	ENd If
		If Pos(  'association,custom_n1, custom_1' , lower(is_CurObj) ) > 0  Or  Pos(  'association_t,custom_n1_t, custom_1_t' , lower(is_CurObj) ) > 0  Then
		inv_data_design.Post of_AutoUpdateSearchScreen(is_CurObj, ls_TObj )		
	End If
Elseif inv_data_design.is_open_style = "screen" and ( inv_data_design.ii_Screen_id =31 ) then 
	ls_TObj = 'feesched_' + is_CurObj
	inv_data_design.Post of_AutoUpdateSearchScreen(is_CurObj, ls_TObj )		
Else
	inv_data_design.of_AutoUpdateSearchScreen(is_CurObj)
	inv_data_design.of_AutoUpdateDetailScreen(is_CurObj)	//Jervis 10.21.2010
End If
end event

event editchanged;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-15 By: Andy
pfc_cst_u_band ldw_band
String ls_Modify, ls_fieldname

//modify by gavin on 2009/3/4
//if isValid(w_contract_data_design) then 
if isValid(inv_data_design) then
	ib_ModifyText = true
	ldw_band = inv_data_design.wf_getband(inv_data_design.is_curBand)
	if isNull(ldw_band.is_curobj) or ldw_band.is_curobj = "" then return
	
	//$<modify> 04.10.2008 by Andy
	//Reason:   fixed BugG041001,Issue 2 from Issues for Tracy.doc
	//ls_Modify = ldw_band.is_curobj + ".text = '" + data + "'"
	//$<modify> 04.17.2008 by nova
	//Reason:   fixed BugG
	
	is_CurObj = ldw_band.is_curobj
	
	ls_Modify = is_CurObj + ".text = ~"" + data + "~""
	
	ldw_band.modify( ls_Modify )
	inv_data_design.event ue_setModify(ls_Modify)
	
	if inv_data_design.dw_properties.GetRow() > 0 then 
		inv_data_design.dw_properties.SetItem(1, "data_view_fields_field_label", data )
		//$<add> 03.26.2008 by Andy
		//$Reason:Auto set view fields alias
		ldw_band.of_set_dw_properties( "data_view_fields_field_label" )
	Else
		//Added By Ken.Guo 07/04/2012
		If right(is_CurObj,2) = '_t' Then
			ls_fieldname = Mid(is_CurObj, 1, Len(is_CurObj) - 2)
			ldw_band.of_modify_column_alais( ls_fieldname, 'data_view_fields_field_label',data)
		End If				
	end if
	//end modify 04.10.2008
	
	ib_HasModify = true
end if

/*
if upperbound(w_contract_data_design.uo_design.is_last_object[]) < 1 then //maha 100404

else
	w_contract_data_design.uo_design.idw_detail.Modify( w_contract_data_design.uo_design.is_last_object[1] + ".text = '" + data + "'")
	w_contract_data_design.uo_design.dw_properties.SetItem(1, "data_view_fields_field_label", data )
end if
*/
//---------------------------- APPEON END ----------------------------

end event

event constructor;dw_1.insertrow(0)

end event

event getfocus;ib_HasModify = false
end event

event losefocus;AcceptText( )

if ib_HasModify then
	ib_HasModify = false
	Event ue_dwnprocessenter( )  //modified by gavins 20120607
//	inv_data_design.of_AutoUpdateSearchScreen(is_CurObj)
//	inv_data_design.of_AutoUpdateDetailScreen(is_CurObj)	//Jervis 10.21.2010
end if
ib_ModifyText = false
end event

event itemchanged;String ls_data
Integer 		li_rtn

AcceptText( )
If Len( data ) > 0 Then
	Long ll_Pos, ll_LeftBracketCnts, ll_RightBracketCnts
	
	ll_Pos = Pos(data,"(")
	do while ll_Pos > 0
		ll_LeftBracketCnts++
		ll_Pos = Pos(data,"(",ll_Pos + 1)
	loop
	
	ll_Pos = Pos(data,")")
	do while ll_Pos > 0
		ll_RightBracketCnts++
		ll_Pos = Pos(data,")",ll_Pos + 1)
	loop
	
	if ll_LeftBracketCnts < ll_RightBracketCnts then
		MessageBox(gnv_app.iapp_object.DisplayName, "Unpaired ‘)’ is not allowed and it will be replaced by ‘>’.",StopSign!)
		ll_pos= pos( data, ')' )
		ls_data = data
		do while ll_pos > 0 
			ls_data = replace( ls_data, ll_pos, 1, '>' )
			ll_pos = Pos( ls_data, ')', ll_pos +  1 )			
		loop
		SetText( ls_data )
		SetItem( row, 'label', ls_data )
		event editchanged( row, dwo, ls_data )
		Return 2
	end if				
	
	//Begin - Added By Mark Lee 11/08/2012
	If inv_data_design.ii_Screen_id = 1  Then
		Choose Case is_CurObj
			Case 'b_quick_filter1'
				If lower(String(data) )<> 'quick filter1' Then 
					li_rtn = Messagebox(gnv_app.iapp_object.DisplayName,"You cannot change the value for 'Quick Filter1' in design pane.~r~n" +&
						"~r~nTo change its value, please go to Contract--->Search---> Save Filter...--->’button’--->Rename Filter.",  &
					Information!,OK!)
					SetText(  'Quick Filter1'  )
					SetItem( row, 'label',  'Quick Filter1' )
					event editchanged( row, dwo,  'Quick Filter1' )
					Return 2
				End If 
			Case 'b_quick_filter2' 
				If lower(String(data) )<> 'quick filter2' Then 
					li_rtn = Messagebox(gnv_app.iapp_object.DisplayName,"You cannot change the value for 'Quick Filter2' in design pane.~r~n" +&
						"~r~nTo change its value, please go to Contract--->Search---> Save Filter...--->’button’--->Rename Filter.",  &
					Information!,OK!)
					SetText(  'Quick Filter2'  )
					SetItem( row, 'label',  'Quick Filter2' )
					event editchanged( row, dwo,  'Quick Filter2' )
					Return 2
				End If 
			Case 'b_quick_filter3' 	
				If lower(String(data) )<> 'quick filter3' Then 
					li_rtn = Messagebox(gnv_app.iapp_object.DisplayName,"You cannot change the value for 'Quick Filter3' in design pane.~r~n" +&
						"~r~nTo change its value, please go to Contract--->Search---> Save Filter...--->’button’--->Rename Filter.",  &
					Information!,OK!)
					SetText(  'Quick Filter3'  )
					SetItem( row, 'label',  'Quick Filter3' )
					event editchanged( row, dwo,  'Quick Filter3' )
					Return 2
				End If 
			Case Else
				
		End Choose
	End If
	//End - Added By Mark Lee 11/08/2012

End If		
end event

type r_6 from rectangle within uo_contract_design_menu
integer linethickness = 4
long fillcolor = 33551856
integer x = 2843
integer y = 32
integer width = 791
integer height = 220
end type

type r_1 from rectangle within uo_contract_design_menu
integer linethickness = 4
long fillcolor = 33551856
integer x = 1422
integer y = 32
integer width = 288
integer height = 220
end type

type r_2 from rectangle within uo_contract_design_menu
integer linethickness = 4
long fillcolor = 33551856
integer x = 864
integer y = 32
integer width = 526
integer height = 220
end type

type r_3 from rectangle within uo_contract_design_menu
integer linethickness = 4
long fillcolor = 80269524
integer x = 1742
integer y = 32
integer width = 425
integer height = 220
end type

type r_4 from rectangle within uo_contract_design_menu
integer linethickness = 4
long fillcolor = 80269524
integer x = 2199
integer y = 32
integer width = 283
integer height = 220
end type

type p_1 from picture within uo_contract_design_menu
integer x = 2592
integer y = 336
integer width = 73
integer height = 64
boolean originalsize = true
string picturename = "SizeVertical!"
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
boolean map3dcolors = true
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy

/*
Integer i
String ls_syntax


This.BorderStyle = StyleLowered!	

FOR i = 1 TO w_contract_data_design.uo_design.ii_obj_select_cnt
	w_contract_data_design.uo_design.idw_detail.Modify( w_contract_data_design.uo_design.is_last_object[i] + ".height = '" + String(w_contract_data_design.uo_design.il_last_object_height[1]) + "'" )
END FOR

This.BorderStyle = StyleRaised!	
*/

//modify by gavin on 2009/3/4
//if isValid(w_contract_data_design) then
//	w_contract_data_design.event ue_arrange('same_height')
//end if

if isValid(inv_data_design) then
	inv_data_design.event ue_arrange('same_height')
end if
//---------------------------- APPEON END ----------------------------

end event

type p_alignleft_1 from picture within uo_contract_design_menu
integer x = 2592
integer y = 436
integer width = 73
integer height = 64
boolean originalsize = true
string picturename = "AlignLeft!"
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
boolean map3dcolors = true
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy

/*
Integer i
String ls_syntax


This.BorderStyle = StyleLowered!	

FOR i = 1 TO w_contract_data_design.uo_design.ii_obj_select_cnt
	w_contract_data_design.uo_design.idw_detail.Modify( w_contract_data_design.uo_design.is_last_object[i] + ".x = '" + String(w_contract_data_design.uo_design.il_last_object_x[1]) + "'" )
END FOR

This.BorderStyle = StyleRaised!	
*/

//modify by gavin on 2009/3/4
//if isValid(w_contract_data_design) then
//	w_contract_data_design.event ue_arrange('snap_to_left')
//end if

if isValid(inv_data_design) then
	inv_data_design.event ue_arrange('snap_to_left')
end if
//---------------------------- APPEON END ----------------------------

end event

type st_7 from statictext within uo_contract_design_menu
integer x = 1061
integer y = 4
integer width = 192
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Objects"
boolean focusrectangle = false
end type

type st_tab_order from statictext within uo_contract_design_menu
integer x = 1431
integer y = 60
integer width = 265
integer height = 88
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
string text = "Tab Order"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;//start--modify by gavin on 2009-02-26

If of_MessageBox( '' ) = -1 Then Return

IF IsValid(inv_data_design) then
   inv_data_design.ib_disable_activate = TRUE
//	w_contract_data_design.ib_disable_activate = TRUE

	IF This.BorderStyle = StyleLowered! THEN
		This.BorderStyle = StyleRaised!
		inv_data_design.of_set_tab_order( False )
	ELSE
		This.BorderStyle = StyleLowered!
		inv_data_design.of_set_tab_order( True )
	END IF
	
//	w_contract_data_design.ib_disable_activate = FALSE
	inv_data_design.ib_disable_activate = FALSE
	//End--modify by gavin on 2009-02-26
END IF
end event

type st_copysize from statictext within uo_contract_design_menu
integer x = 2459
integer y = 324
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 79741120
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;if IsValid(inv_data_design) then
	inv_data_design.event ue_arrange('same_width')
end if

end event

type st_aligntop from statictext within uo_contract_design_menu
integer x = 2459
integer y = 424
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 79741120
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;if IsValid(inv_data_design) then
	inv_data_design.event ue_arrange('snap_to_top')
end if

end event

type st_12 from statictext within uo_contract_design_menu
integer x = 2578
integer y = 324
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 79741120
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;if IsValid(inv_data_design) then
	inv_data_design.event ue_arrange('same_height')
end if

end event

type st_alignleft from statictext within uo_contract_design_menu
integer x = 2578
integer y = 424
integer width = 105
integer height = 88
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 79741120
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;if IsValid(inv_data_design) then
	inv_data_design.event ue_arrange('snap_to_left')
end if

end event

type r_5 from rectangle within uo_contract_design_menu
integer linethickness = 4
long fillcolor = 33551856
integer y = 36
integer width = 837
integer height = 212
end type

type pb_column from picturebutton within uo_contract_design_menu
integer x = 891
integer y = 60
integer width = 105
integer height = 88
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Justify!"
boolean map3dcolors = true
string powertiptext = "Add Field control"
end type

event clicked;//BEGIN---Modify by Scofield on 2010-03-29
if IsValid(inv_data_design) then
	inv_data_design.Trigger Event ue_AddField()
end if
//END---Modify by Scofield on 2010-03-29

end event

type pb_text from picturebutton within uo_contract_design_menu
integer x = 1129
integer y = 60
integer width = 105
integer height = 88
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "StaticText!"
boolean map3dcolors = true
string powertiptext = "Add Text control"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy
//Integer li_object_no
//long ll_scroll
//long ll_y
//String ls_obj_name
//
//ll_scroll = Long(w_contract_data_design.uo_design.idw_detail.Object.DataWindow.VerticalScrollPosition)
//ll_y = ll_scroll + 20
//
//if w_contract_data_design.triggerevent("pfc_save") < 1 then return -1
//
//FOR li_object_no = 1 TO 1000
//	ls_obj_name = w_contract_data_design.uo_design.idw_detail.Describe("object" + String(li_object_no) + "_t.name")
//	IF ls_obj_name = "object" + String(li_object_no) + "_t" THEN CONTINUE
//
//	w_contract_data_design.uo_design.idw_detail.Modify("create text(band=detail text='text' border='0' color='0' x='20' y='" + string(ll_y) + "' height='52' width='150'  font.face='Segoe UI' font.height='-8' font.weight='400'  font.family='2' font.pitch='2' font.charset='0' background.mode='1' background.color='553648127' name=object" + String(li_object_no) + "_t)"  )
//	EXIT
//NEXT

//modify by gavin on 2009/3/4
//if isValid(w_contract_data_design) then 
//	w_contract_data_design.event ue_new('text')
//end if
IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('text')
END IF

//---------------------------- APPEON END ----------------------------
end event

type pb_compute from picturebutton within uo_contract_design_menu
integer x = 1010
integer y = 60
integer width = 105
integer height = 88
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Compute5!"
boolean map3dcolors = true
string powertiptext = "Add Compute control"
end type

event clicked;////<add>      06/21/2007 by: Andy
//--------------------------- APPEON BEGIN ---------------------------
//$<Modify> 2007-11-09 By: Andy

////describe : create computer field
//Integer  li_object_no
//long     ll_scroll
//long     ll_y
//String   ls_obj_name,ls_modify,ls_Err
//String   ls_Expression
//str_pass lstr_pass,lstr_Ret
//u_dw     ldw_Temp
//
//ldw_Temp  = w_contract_data_design.uo_design.idw_detail
//ll_scroll = Long(ldw_Temp.Object.DataWindow.VerticalScrollPosition)
//ll_y      = ll_scroll + 20
//
//if w_contract_data_design.triggerevent("pfc_save") < 1 then return -1
////--------------------------- APPEON BEGIN ---------------------------
////$<Modify> 2007-10-29 By: Andy
////$<Reason> compute.name = compute_xx_c
//FOR li_object_no = 1 TO 1000
//	ls_obj_name = ldw_Temp.Describe("compute_" + String(li_object_no) + ".name")
//	IF lower(ls_obj_name) = "compute_" + String(li_object_no) + "_c" THEN CONTINUE
//
//	ls_modify = "create compute(band=detail expression='' border='0' color='0' x='20'" + &
//					" y='" + string(ll_y) + "' height='52' width='520' format='[GENERAL]' name=compute_" + String(li_object_no) + "_c" + " visible='1'" + &
//					" font.face='Segoe UI' font.height='-8' font.weight='400'  font.family='2' font.pitch='2' font.charset='0'" + &
//					" background.mode='1' background.color='536870912' tag='' )"//background.mode='2' background.color='1073741824'
//	ls_Err    = ldw_Temp.Modify(ls_modify)	
//	ls_obj_name   = "compute_" + String(li_object_no) + "_c"
//	ls_Expression = ''
//	EXIT
//NEXT
////---------------------------- APPEON END ----------------------------
//
//lstr_pass.l_facility_id     = -1//-1:screen/else:export
//lstr_pass.s_string          = ls_Expression//expression
//lstr_pass.s_string_array[1] = ls_obj_name//object name
//lstr_pass.s_u_dw            = ldw_Temp//relative dw
//openwithparm(w_export_expression,lstr_pass)
//
//lstr_Ret = message.Powerobjectparm
////canceled
//if Not IsValid(lstr_Ret) or ISNULL(lstr_Ret) THEN 
//	ldw_Temp.Modify("destroy " + ls_obj_name)
//end if
////end of add

//modify by gavin on 2009/3/4
if isValid(inv_data_design) then 
	inv_data_design.event ue_new('compute')
end if
//---------------------------- APPEON END ----------------------------
end event

type st_3 from statictext within uo_contract_design_menu
boolean visible = false
integer x = 2514
integer y = 4
integer width = 320
integer height = 68
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Adjust Width"
alignment alignment = center!
boolean focusrectangle = false
end type

type st_4 from statictext within uo_contract_design_menu
boolean visible = false
integer x = 2510
integer y = 136
integer width = 306
integer height = 52
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 128
long backcolor = 33551856
boolean enabled = false
string text = "Move "
alignment alignment = center!
boolean focusrectangle = false
end type

type hsb_1 from hscrollbar within uo_contract_design_menu
boolean visible = false
integer x = 2510
integer y = 64
integer width = 306
integer height = 68
boolean bringtotop = true
end type

event constructor;This.MinPosition = 1
This.MaxPosition = 3
This.Position = 2
end event

event lineleft;
If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_width( -25 )

end event

event lineright;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_width( 25 )
end event

event pageleft;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_width( -75 )
end event

event pageright;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_width( 75 )
end event

type hsb_2 from hscrollbar within uo_contract_design_menu
boolean visible = false
integer x = 2510
integer y = 184
integer width = 306
integer height = 68
boolean bringtotop = true
integer minposition = 3
integer maxposition = 1
integer position = 2
end type

event constructor;This.MinPosition = 1
This.MaxPosition = 3
This.Position = 2
end event

event lineleft;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_position( -25 )


end event

event lineright;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_position( 25 )


end event

event pageleft;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_position( -75 )


end event

event pageright;If of_MessageBox( '' ) = -1 Then Return
w_contract_data_design.uo_design.of_adjust_position( 75 )


end event

type p_bold from p_toolbar_button within uo_contract_design_menu
integer x = 1783
integer y = 60
string picturename = "Bold_Normal.jpg"
string powertiptext = "Bold"
end type

event constructor;call super::constructor;of_InitPicture("Bold_Up.jpg","Bold_Normal.jpg","Bold_Down.jpg")

end event

event ue_lbuttondown;call super::ue_lbuttondown;String ls_ProExp

if il_Status = 3 then
	ls_ProExp = ".font.weight='700'"
else
	ls_ProExp = ".font.weight='400'"
end if

of_ModifySelObjsAttr(ls_ProExp)

end event

type p_italic from p_toolbar_button within uo_contract_design_menu
integer x = 1902
integer y = 60
string picturename = "Italic_Normal.jpg"
string powertiptext = "Italic"
end type

event constructor;call super::constructor;of_InitPicture("Italic_Up.jpg","Italic_Normal.jpg","Italic_Down.jpg")

end event

event ue_lbuttondown;call super::ue_lbuttondown;String ls_ProExp

if il_Status = 3 then
	ls_ProExp = ".font.italic='1'"
else
	ls_ProExp = ".font.italic='0'"
end if

of_ModifySelObjsAttr(ls_ProExp)

end event

type p_underline from p_toolbar_button within uo_contract_design_menu
integer x = 2021
integer y = 60
string picturename = "UnderLine_Normal.jpg"
string powertiptext = "Underline"
end type

event constructor;call super::constructor;of_InitPicture("UnderLine_Up.jpg","UnderLine_Normal.jpg","UnderLine_Down.jpg")

end event

event clicked;call super::clicked;String   ls_ObjName,ls_ColName,ls_Type,ls_Modify,ls_Syntax,ls_Err,ls_Field_id,ls_EditStyle
long		ll_Cycle,ll_TotalCnts,ll_SetupCnts,ll_SelObjCnts,ll_Rtn

ll_SelObjCnts = inv_Data_Design.of_GetSelectedObjectCnts()
if ll_SelObjCnts <= 0 then Return
	
if il_Status = 3 then
	ls_Syntax = ".font.underline='1'"
else
	ls_Syntax = ".font.underline='0'"
end if

ll_TotalCnts = UpperBound(inv_Data_Design.istr_SelectObj)
for ll_Cycle = 1 to ll_TotalCnts
	ls_ObjName = inv_Data_Design.istr_SelectObj[ll_Cycle].FName
	if IsNull(ls_ObjName) or ls_ObjName = '' then Continue
	
	ls_Type = inv_Data_Design.of_GetSelectedObjectType(ls_ObjName)
	if ls_Type <> "text" and ls_Type <> "compute" and ls_Type <> "column" then Continue
	
	if ls_Type = "text" and Right(ls_ObjName,2) = "_t" then
		ls_ColName = inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Describe(Left(ls_ObjName,Len(ls_ObjName) - 2) + ".Name")
	end if
	
	if ls_Type = 'compute' or ls_ColName = "?" or ls_ColName = "!" then
		inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Modify(ls_ObjName + ls_Syntax)
		inv_Data_Design.Event ue_SetModify(ls_ObjName + ls_Syntax)
	else
		if ll_Rtn <> 0 and ll_Rtn <> 1 then Continue
		
		if Lower(ls_Type) = "column" then
			ls_Field_id = inv_Data_Design.of_GetSelectedObjectID(ls_ObjName)
			ls_ColName = ls_ObjName
		else
			if Right(ls_ObjName, 2) = "_t" then
				ls_Field_id = inv_Data_Design.of_GetSelectedObjectTag(ls_ObjName)
				ls_ColName = Left(ls_ObjName,Len(ls_ObjName) - 2)
			end if
		end if
		
		if IsNull(ls_Field_id) or Trim(ls_Field_id) = "" or ls_Field_id = '!' or ls_Field_id = '?' or Not IsNumber(ls_Field_id) then Continue
		
		inv_Data_Design.dw_Properties.SetFilter("data_view_fields_field_id = " + ls_Field_id)
		inv_Data_Design.dw_Properties.Filter()
		if inv_Data_Design.dw_Properties.RowCount() <= 0 Then Continue
		
		ls_EditStyle = inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Describe(ls_ColName + ".Edit.Style")
		
		if il_Status = 3 then
			if ll_Rtn <> 1 and inv_Data_Design.is_Open_Style = 'screen' then
				ll_Rtn = MessageBox("Underline Format","Only required fields are underlined.  Would you like to make this a required field?", Question!,YesNo!,1)
				if ll_Rtn = 1 then
					ll_SetupCnts++
				else
					Continue
				end if
			end if
			inv_Data_Design.dw_Properties.SetItem(1,"data_view_fields_required",'Y')
			ls_Modify  = " " + ls_ColName + "." + ls_EditStyle + ".Required = 'Yes'"
		else
			inv_Data_Design.dw_Properties.SetItem(1,"data_view_fields_required",'N')
			ls_Modify  = " " + ls_ColName + "." + ls_EditStyle + ".Required = 'No'"
		end if
		
		ls_Modify += " " + ls_ColName + "_t" + ls_Syntax
		
		inv_Data_Design.dw_Properties.Accepttext()
		inv_Data_Design.istr_SelectObj[ll_Cycle].FBand.Modify(ls_Modify)
		inv_Data_Design.Event ue_SetModify(ls_Modify)
	end if
next

if il_Status = 3 and ll_SetupCnts <= 0 then
	This.of_SetNormalStatus()
end if

end event

type p_left from p_toolbar_button within uo_contract_design_menu
integer x = 1783
integer y = 152
string picturename = "LeftAlign_Normal.jpg"
string powertiptext = "Left"
end type

event constructor;call super::constructor;of_InitPicture("LeftAlign_Up.jpg","LeftAlign_Normal.jpg","LeftAlign_Down.jpg")

end event

event ue_lbuttondown;p_Left.of_SetDownStatus()
p_Center.of_SetNormalStatus()
p_Right.of_SetNormalStatus()

of_AlignSelObjs(0)

end event

type p_center from p_toolbar_button within uo_contract_design_menu
integer x = 1902
integer y = 152
string picturename = "CenterAlign_Normal.jpg"
string powertiptext = "Center"
end type

event constructor;call super::constructor;of_InitPicture("CenterAlign_Up.jpg","CenterAlign_Normal.jpg","CenterAlign_Down.jpg")

end event

event ue_lbuttondown;p_Left.of_SetNormalStatus()
p_Center.of_SetDownStatus()
p_Right.of_SetNormalStatus()

of_AlignSelObjs(2)

end event

type p_right from p_toolbar_button within uo_contract_design_menu
integer x = 2021
integer y = 152
string picturename = "RightAlign_Normal.jpg"
string powertiptext = "Right"
end type

event constructor;call super::constructor;of_InitPicture("RightAlign_Up.jpg","RightAlign_Normal.jpg","RightAlign_Down.jpg")

end event

event ue_lbuttondown;p_Left.of_SetNormalStatus()
p_Center.of_SetNormalStatus()
p_Right.of_SetDownStatus()

of_AlignSelObjs(1)

end event

type st_show_invisible from statictext within uo_contract_design_menu
boolean visible = false
integer x = 325
integer y = 108
integer width = 466
integer height = 76
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
long textcolor = 33554432
long backcolor = 67108864
string text = "Show Invisible"
alignment alignment = center!
boolean border = true
borderstyle borderstyle = styleraised!
boolean focusrectangle = false
end type

event clicked;//start--modify by gavin on 2009-03-04
//IF This.BorderStyle = StyleLowered! THEN
//	This.BorderStyle = StyleRaised!
//	w_contract_data_design.uo_design.of_show_invisible( True )
//	w_contract_data_design.uo_design.ib_show_invisible = True
//ELSE
//	This.BorderStyle = StyleLowered!
//	w_contract_data_design.uo_design.of_show_invisible( False )
//	w_contract_data_design.uo_design.ib_show_invisible = False
//END IF

IF IsValid(inv_data_design) then
	IF This.BorderStyle = StyleLowered! THEN
		This.BorderStyle = StyleRaised!
		inv_data_design.of_show_invisible( True )
		inv_data_design.ib_show_invisible = True
	ELSE
		This.BorderStyle = StyleLowered!
		inv_data_design.of_show_invisible( False )
		inv_data_design.ib_show_invisible = False
	END IF
END IF
//End--modify by gavin on 2009-03-04


end event

type pb_gridoval from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 1010
integer y = 152
integer width = 105
integer height = 88
integer taborder = 30
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Oval!"
boolean map3dcolors = true
string powertiptext = "Add Oval control"
end type

event clicked;//--------------------------- APPEON BEGIN ---------------------------
//$< Add  > 2009-03-02 By: Scofield
//$<Reason> Create a new oval.

//if IsValid(w_contract_data_design) then 
//	w_contract_data_design.event ue_new("oval")
//end if
If of_MessageBox( '' ) = -1 Then Return
IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('oval')
END IF

//---------------------------- APPEON END ----------------------------

end event

type pb_gridpicture from picturebutton within uo_contract_design_menu
boolean visible = false
integer x = 1248
integer y = 152
integer width = 105
integer height = 88
integer taborder = 50
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Picture5!"
boolean map3dcolors = true
string powertiptext = "Add Picture control"
end type

event clicked;//Create Picture Control - jervis 11.20.2009

If of_MessageBox( '' ) = -1 Then Return
IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('picture')
END IF

end event

type pb_line from picturebutton within uo_contract_design_menu
integer x = 1129
integer y = 152
integer width = 105
integer height = 88
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Segoe UI"
string picturename = "Line!"
boolean map3dcolors = true
string powertiptext = "Add Line control"
end type

event clicked;IF IsValid(inv_data_design) then
	inv_data_design.event ue_new('line')
END IF
end event

