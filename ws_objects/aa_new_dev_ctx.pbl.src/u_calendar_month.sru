$PBExportHeader$u_calendar_month.sru
forward
global type u_calendar_month from u_calendar_ancestor
end type
type dw_disp_list_42 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_41 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_40 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_39 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_38 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_37 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_36 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_35 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_34 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_33 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_32 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_31 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_30 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_29 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_25 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_26 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_27 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_28 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_21 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_20 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_19 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_18 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_17 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_24 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_23 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_16 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_22 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_15 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_14 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_13 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_12 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_11 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_10 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_09 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_08 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_07 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_06 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_05 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_04 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_03 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_02 from u_dw_calendar_item within u_calendar_month
end type
type dw_disp_list_01 from u_dw_calendar_item within u_calendar_month
end type
type r_frame from rectangle within u_calendar_month
end type
type dw_month_calendar from datawindow within u_calendar_month
end type
end forward

global type u_calendar_month from u_calendar_ancestor
integer width = 3630
integer height = 2532
long backcolor = 67108864
long picturemaskcolor = 536870912
dw_disp_list_42 dw_disp_list_42
dw_disp_list_41 dw_disp_list_41
dw_disp_list_40 dw_disp_list_40
dw_disp_list_39 dw_disp_list_39
dw_disp_list_38 dw_disp_list_38
dw_disp_list_37 dw_disp_list_37
dw_disp_list_36 dw_disp_list_36
dw_disp_list_35 dw_disp_list_35
dw_disp_list_34 dw_disp_list_34
dw_disp_list_33 dw_disp_list_33
dw_disp_list_32 dw_disp_list_32
dw_disp_list_31 dw_disp_list_31
dw_disp_list_30 dw_disp_list_30
dw_disp_list_29 dw_disp_list_29
dw_disp_list_25 dw_disp_list_25
dw_disp_list_26 dw_disp_list_26
dw_disp_list_27 dw_disp_list_27
dw_disp_list_28 dw_disp_list_28
dw_disp_list_21 dw_disp_list_21
dw_disp_list_20 dw_disp_list_20
dw_disp_list_19 dw_disp_list_19
dw_disp_list_18 dw_disp_list_18
dw_disp_list_17 dw_disp_list_17
dw_disp_list_24 dw_disp_list_24
dw_disp_list_23 dw_disp_list_23
dw_disp_list_16 dw_disp_list_16
dw_disp_list_22 dw_disp_list_22
dw_disp_list_15 dw_disp_list_15
dw_disp_list_14 dw_disp_list_14
dw_disp_list_13 dw_disp_list_13
dw_disp_list_12 dw_disp_list_12
dw_disp_list_11 dw_disp_list_11
dw_disp_list_10 dw_disp_list_10
dw_disp_list_09 dw_disp_list_09
dw_disp_list_08 dw_disp_list_08
dw_disp_list_07 dw_disp_list_07
dw_disp_list_06 dw_disp_list_06
dw_disp_list_05 dw_disp_list_05
dw_disp_list_04 dw_disp_list_04
dw_disp_list_03 dw_disp_list_03
dw_disp_list_02 dw_disp_list_02
dw_disp_list_01 dw_disp_list_01
r_frame r_frame
dw_month_calendar dw_month_calendar
end type
global u_calendar_month u_calendar_month

type variables
CONSTANT LONG ROWCOUNT = 6
CONSTANT LONG COLCOUNT = 7

CONSTANT LONG DEFAULTDATETITLEHEIGHT = 84

CONSTANT LONG MOREPICWIDTH = 59

CONSTANT STRING MONTHDAYBGYELLOW = "MonthDayTitleBG_Yellow.gif"
CONSTANT STRING MONTHDAYBGBLUE   = "MonthDayTitleBG_Blue.gif"

long	il_DispRowCnts = ROWCOUNT
Date	id_MonthFirst,id_MonthCurrent

m_Calendar_Month		m_PopMonth

end variables

forward prototypes
public subroutine of_goto_prev_month ()
public subroutine of_goto_next_month ()
public subroutine of_resetlayout ()
public subroutine of_pitchondate (string as_name)
public subroutine of_draw_month (date ad_monthcurrent)
public function long of_days_in_month (date ad_monthcurrent)
public function date of_get_next_month ()
public function date of_get_prev_month ()
public subroutine of_regresize ()
public function date of_get_current_date ()
public subroutine of_refreshfiltername (string as_filtername1, string as_filtername2, string as_filtername3)
end prototypes

public subroutine of_goto_prev_month ();//====================================================================
// Function: of_GoTo_Prev_Month()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  (None)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-10
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

long	ll_PreMonthDays,ll_Day
Date	ld_PreMonth

ld_PreMonth = RelativeDate(id_MonthFirst,-1)

ll_PreMonthDays = of_Days_In_Month(ld_PreMonth)
ll_Day = Day(id_MonthCurrent)
if ll_Day > ll_PreMonthDays then
	ll_Day = ll_PreMonthDays
end if

of_Draw_Month(Date(Year(ld_PreMonth),Month(ld_PreMonth),ll_Day))

end subroutine

public subroutine of_goto_next_month ();//====================================================================
// Function: of_GoTo_Next_Month()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  (None)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-10
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

long	ll_CurrMonthDays,ll_NextMonthDays,ll_Day
Date	ld_NextMonth

ll_CurrMonthDays = of_Days_In_Month(id_MonthFirst)
ld_NextMonth = RelativeDate(id_MonthFirst,ll_CurrMonthDays)

ll_Day = Day(id_MonthCurrent)
ll_NextMonthDays = of_Days_In_Month(ld_NextMonth)
if ll_Day > ll_NextMonthDays then
	ll_Day = ll_NextMonthDays
end if

of_Draw_Month(Date(Year(ld_NextMonth),Month(ld_NextMonth),ll_Day))

end subroutine

public subroutine of_resetlayout ();//====================================================================
// Function: of_ResetLayout()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  (None)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-11
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

long		ll_RowNo,ll_ColNo,ll_Num,ll_dwInitXPos,ll_dwInitYPos,ll_dwHeaderHeight,ll_dwDetailHeight
long		ll_ColXPos,ll_ColYPos,ll_MarkXPos,ll_MarkYPos,ll_AreaWidth,ll_AreaHeight,ll_IsDisplay
long		ll_Cycle,ll_XPos,ll_Width
String	ls_LabelName,ls_BKPicName,ls_VerLName,ls_HeaLName
String 	ls_WeekName,ls_AreaBKName,ls_Modify,ls_Syntax

ll_dwHeaderHeight = long(dw_Month_Calendar.Describe("DataWindow.Header.Height"))
ll_dwDetailHeight = dw_Month_Calendar.Height - ll_dwHeaderHeight - 4

dw_Month_Calendar.Modify("DataWindow.Detail.Height = '" + String(ll_dwDetailHeight) + "'")

//////////////Adjust the object size and position//////////////
ll_XPos = dw_Month_Calendar.Width

for ll_Cycle = 3 to 0 Step -1
	ll_Width = long(dw_Month_Calendar.Describe("p_" + ACTIONITEMFILTERNAME + String(ll_Cycle) + ".Width"))
	ll_XPos = ll_XPos - ll_Width - ACTIONITEMFILTERSPACE
	
	ls_Syntax += "p_" + ACTIONITEMFILTERNAME + String(ll_Cycle) + ".X = " + String(ll_XPos) + " "
	ls_Syntax += "t_" + ACTIONITEMFILTERNAME + String(ll_Cycle) + ".X = " + String(ll_XPos) + " "
next

ll_Width = long(dw_Month_Calendar.Describe("p_" + ARRANGEMODE + ".Width"))
ll_XPos = ll_XPos - ll_Width - ACTIONITEMFILTERSPACE

ls_Syntax += "p_" + ARRANGEMODE + ".X = " + String(ll_XPos) + " "
ls_Syntax += "t_" + ARRANGEMODE + ".X = " + String(ll_XPos) + " "
///////////////////////////////////////////////////////////////

ll_AreaWidth  = long(dw_Month_Calendar.Width/COLCOUNT + DATEHORISPACE)
ll_AreaHeight = long((ll_dwDetailHeight - DEFAULTDATEINITY - DEFAULTDATETITLEHEIGHT * il_DispRowCnts)/il_DispRowCnts)

ll_dwInitXPos  = dw_Month_Calendar.X + DWINDENTDEPTH
ll_dwInitYPos  = dw_Month_Calendar.Y + ll_dwHeaderHeight + DEFAULTDATETITLEHEIGHT + DWINDENTDEPTH

for ll_RowNo = 1 to ROWCOUNT
	for ll_ColNo = 1 to COLCOUNT
		ll_Num = (ll_RowNo - 1) * COLCOUNT + ll_ColNo
		ls_LabelName  = DATELABELMARK + String(ll_Num,"00") + "_t"
		ls_BKPicName  = BACKGDPICMARK + String(ll_Num,"00") + "_p"
		ls_AreaBKName = AREABKMARK    + String(ll_Num,"00") + "_t"
		
		ll_ColXPos = DEFAULTDATEINITX + (ll_ColNo - 1) * (ll_AreaWidth + DATEHORISPACE)
		ll_ColYPos = DEFAULTDATEINITY + (ll_RowNo - 1) * (DEFAULTDATETITLEHEIGHT + ll_AreaHeight)
		
		if idw_Disp_List[ll_Num].Visible then
			idw_Disp_List[ll_Num].X = ll_dwInitXPos + ll_ColXPos
			idw_Disp_List[ll_Num].Y = ll_dwInitYPos + ll_ColYPos
			idw_Disp_List[ll_Num].Width  = ll_AreaWidth - TEXTINDENTDEPTH
			idw_Disp_List[ll_Num].Height = ll_AreaHeight - 8
			
			idw_Disp_List[ll_Num].Modify("DataWindow.Footer.Height = 0")
			
			ls_Modify  = "disp_value.Width = '" + String(ll_AreaWidth - TEXTINDENTDEPTH * 12) + "' "
			ls_Modify += "p_small_background.Width = '" + String(ll_AreaWidth - TEXTINDENTDEPTH * 4) + "' "
			
			ll_IsDisplay = long(idw_Disp_List[ll_Num].Describe("Evaluate('if(RowCount() = Last(GetRow() for Page),0,1)',1)"))
			if ll_IsDisplay = 1 then
				ls_Modify += "DataWindow.Footer.Height = 80 "
				ls_Modify += "p_more.X = '" + String(long(ll_AreaWidth - MOREPICWIDTH - 50)) + "' "
			end if
			
			idw_Disp_List[ll_Num].Modify(ls_Modify)
		end if
		
		ls_Syntax += ls_BKPicName  + ".X = "      + String(ll_ColXPos) + " " + &
						 ls_BKPicName  + ".Y = "      + String(ll_ColYPos) + " " + &
						 ls_BKPicName  + ".Width = "  + String(ll_AreaWidth) + " " + &
						 ls_BKPicName  + ".Height = " + String(DEFAULTDATETITLEHEIGHT) + " " + &
						 ls_LabelName  + ".X = "      + String(ll_ColXPos + TEXTINDENTDEPTH) + " " + &
						 ls_LabelName  + ".Y = "      + String(ll_ColYPos + TEXTINDENTDEPTH) + " " + &
						 ls_LabelName  + ".Width = "  + String(ll_AreaWidth - 2 * TEXTINDENTDEPTH) + " " + &
						 ls_LabelName  + ".Height = " + String(DEFAULTDATETITLEHEIGHT - 2 * TEXTINDENTDEPTH) + " " + &
						 ls_AreaBKName + ".X = "      + String(ll_ColXPos) + " " + &
						 ls_AreaBKName + ".Y = "      + String(ll_ColYPos + DEFAULTDATETITLEHEIGHT) + " " + &
						 ls_AreaBKName + ".Width = "  + String(ll_AreaWidth) + " " + &
						 ls_AreaBKName + ".Height = " + String(ll_AreaHeight) + " "
						 
		if ll_RowNo = 1 then
			ls_VerLName = VERLINEMARK  + String(ll_Num,"00") + "_l"
			ls_HeaLName = HEADVERLMARK + String(ll_Num,"00") + "_l"
			ls_WeekName = WEEKDAYMARK  + String(ll_Num,"00") + "_t"
			
			ls_Syntax += ls_VerLName + ".X1 = " + String(ll_ColXPos) + " " + &
							 ls_VerLName + ".X2 = " + String(ll_ColXPos) + " " + &
							 ls_VerLName + ".Y1 = " + String(0) + " " + &
							 ls_VerLName + ".Y2 = " + String(ll_dwDetailHeight) + " " + &
							 ls_HeaLName + ".X1 = " + String(ll_ColXPos) + " " + &
							 ls_HeaLName + ".X2 = " + String(ll_ColXPos) + " " + &
							 ls_WeekName + ".X = "  + String(ll_ColXPos) + " " + &
							 ls_WeekName + ".Width = "  + String(ll_AreaWidth - TEXTINDENTDEPTH) + " "
			
			dw_Month_Calendar.SetPosition(ls_VerLName,"",true)
			dw_Month_Calendar.SetPosition(ls_HeaLName,"",true)
		end if
		
		dw_Month_Calendar.SetPosition(ls_AreaBKName,"",false)
		dw_Month_Calendar.SetPosition(ls_LabelName,"",true)
	next
next

dw_Month_Calendar.Modify(ls_Syntax)

end subroutine

public subroutine of_pitchondate (string as_name);//====================================================================
// Function: of_PitchOnDate()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    string    as_Name
//--------------------------------------------------------------------
// Returns:  (None)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-11
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

String	ls_Current,ls_Modify
long		ll_DayNo,ll_MonthDays,ll_DateAreaNo
Date		ld_Current

if Pos(Lower(as_Name),Lower(AREABKMARK)) > 0 then
	if is_PreColName <> "" and is_PreColColor <> "" then
		dw_Month_Calendar.Modify(is_PreColName + ".Background.Color = '" + is_PreColColor + "'")
		
		ll_DateAreaNo = long(Mid(is_PreColName,Len(AREABKMARK) + 1,2))
		
		idw_Disp_List[ll_DateAreaNo].Modify("DataWindow.Color = '" + String(is_PreColColor) + "'")
		idw_Disp_List[ll_DateAreaNo].Modify("DataWindow.Detail.Color = '" + String(is_PreColColor) + "'")
	end if
	
	is_PreColName  = as_Name
	is_PreColColor = dw_Month_Calendar.Describe(as_Name + ".Background.Color")
	
	dw_Month_Calendar.Modify(as_Name + ".Background.Color = '" + String(SELCOLOR) + "'")
	
	ll_DateAreaNo = long(Mid(as_Name,Len(AREABKMARK) + 1,2))
	
	idw_Disp_List[ll_DateAreaNo].Modify("DataWindow.Color = '" + String(SELCOLOR) + "'")
	idw_Disp_List[ll_DateAreaNo].Modify("DataWindow.Detail.Color = '" + String(SELCOLOR) + "'")
	
	ls_Current = dw_Month_Calendar.Describe(as_Name + ".Tag")
	
	ld_Current = Date(ls_Current)
	Parent.Dynamic of_SetCurrentDate(ld_Current)
	
	ll_DayNo = Day(ld_Current)
	ll_MonthDays = of_Days_in_Month(id_MonthFirst)
	
	if ll_DayNo > ll_MonthDays then ll_DayNo = ll_MonthDays
	id_MonthCurrent = RelativeDate(id_MonthFirst,ll_DayNo - 1)
end if

end subroutine

public subroutine of_draw_month (date ad_monthcurrent);//====================================================================
// Function: of_Draw_Month()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    date    ad_MonthCurrent
//--------------------------------------------------------------------
// Returns:  (None)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-13
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

long		ll_FirstDayWeekNo,ll_Days_In_Month,ll_DateAreaNo
long		ll_Cycle,ll_LastDispNum,ll_Rtn,ll_PitchDay
Date		ld_StartDate,ld_MonthDay
String 	ls_Modify,ls_DayText,ls_PitchArea

id_MonthCurrent = ad_MonthCurrent
id_MonthFirst   = Date(Year(id_MonthCurrent),Month(id_MonthCurrent),1)

ll_Days_In_Month  = of_Days_in_Month(id_MonthFirst)
ll_FirstDayWeekNo = DayNumber(id_MonthFirst)

ld_StartDate = RelativeDate(id_MonthFirst,1 - ll_FirstDayWeekNo)

if ll_FirstDayWeekNo + ll_Days_In_Month - 1 <= (ROWCOUNT - 2) * COLCOUNT then
	il_DispRowCnts = ROWCOUNT - 2
elseif ll_FirstDayWeekNo + ll_Days_In_Month - 1 <= (ROWCOUNT - 1) * COLCOUNT then
	il_DispRowCnts = ROWCOUNT - 1
else
	il_DispRowCnts = ROWCOUNT
end if

ll_LastDispNum = il_DispRowCnts * COLCOUNT

This.SetRedraw(false)
dw_Month_Calendar.SetRedraw(false)

ll_Rtn = of_Fill_Data(ld_StartDate,ll_LastDispNum)
if ll_Rtn < 0 then Return

dw_Month_Calendar.Modify("Year_Month_t.Text = '" + String(id_MonthFirst,"MMMM YYYY") + "'")

//Begin Set the Previous month data
ls_Modify = ""

for ll_Cycle = 1 to ll_FirstDayWeekNo - 1
	ld_MonthDay = RelativeDate(ld_StartDate,ll_Cycle - 1)
	
	if ll_Cycle = 1 then
		ls_DayText = is_Month[Month(ld_MonthDay)] + " " + String(Day(ld_MonthDay))
	else
		ls_DayText = String(Day(ld_MonthDay))
	end if

	ls_Modify += BACKGDPICMARK + String(ll_Cycle,"00") + "_p.Filename = '" + MONTHDAYBGBLUE + "' " + &
	             DATELABELMARK + String(ll_Cycle,"00") + "_t.Text = '" + ls_DayText + "' " + &
					 AREABKMARK    + String(ll_Cycle,"00") + "_t.Background.Color = '" + String(DARKBLUE) + "' " + &
					 AREABKMARK    + String(ll_Cycle,"00") + "_t.Tag = '" + String(ld_MonthDay) + "' "
	
	if idw_Disp_List[ll_Cycle].RowCount() > 0 then
		idw_Disp_List[ll_Cycle].Modify("DataWindow.Color = '" + String(DARKBLUE) + "' DataWindow.Detail.Color = '" + String(DARKBLUE) + "'")
		idw_Disp_List[ll_Cycle].Visible = true
	else
		idw_Disp_List[ll_Cycle].Visible = false
	end if
next

dw_Month_Calendar.Modify(ls_Modify)
//End Set the Previous month data

//Begin Set the current month data
ls_Modify = ""

for ll_Cycle = 1 to ll_Days_In_Month
	ld_MonthDay = RelativeDate(id_MonthFirst,ll_Cycle - 1)
	
	if ll_Cycle = 1 then
		ls_DayText = is_Month[Month(ld_MonthDay)] + " " + String(ll_Cycle)
	else
		ls_DayText = String(ll_Cycle)
	end if
	
	ll_DateAreaNo = ll_FirstDayWeekNo + ll_Cycle - 1
	
	if DaysAfter(ld_MonthDay,Today()) = 0 then
		ls_Modify += BACKGDPICMARK + String(ll_DateAreaNo,"00") + "_p.Filename = '" + MONTHDAYBGYELLOW + "' "
	else
		ls_Modify += BACKGDPICMARK + String(ll_DateAreaNo,"00") + "_p.Filename = '" + MONTHDAYBGBLUE + "' "
	end if
	
	ls_Modify += DATELABELMARK + String(ll_DateAreaNo,"00") + "_t.Text = '" + ls_DayText + "' " + &
	             AREABKMARK    + String(ll_DateAreaNo,"00") + "_t.Background.Color = '" + String(PUREWHITE) + "' " + &
					 AREABKMARK    + String(ll_DateAreaNo,"00") + "_t.Tag = '" + String(ld_MonthDay) + "' "
	
	if idw_Disp_List[ll_DateAreaNo].RowCount() > 0 then
		idw_Disp_List[ll_DateAreaNo].Modify("DataWindow.Color = '" + String(PUREWHITE) + "' DataWindow.Detail.Color = '" + String(PUREWHITE) + "'")
		idw_Disp_List[ll_DateAreaNo].Visible = true
	else
		idw_Disp_List[ll_DateAreaNo].Visible = false
	end if
next

dw_Month_Calendar.Modify(ls_Modify)
//End Set the current month data

//Begin Set the next month data
ls_Modify = ""

for ll_Cycle = ll_FirstDayWeekNo + ll_Days_In_Month to ll_LastDispNum
	ld_MonthDay = RelativeDate(ld_StartDate,ll_Cycle - 1)
	
	if ll_Cycle = ll_FirstDayWeekNo + ll_Days_In_Month then
		ls_DayText = is_Month[Month(ld_MonthDay)] + " " + String(Day(ld_MonthDay))
	else
		ls_DayText = String(Day(ld_MonthDay))
	end if
	
	ls_Modify += BACKGDPICMARK + String(ll_Cycle,"00") + "_p.Filename = '" + MONTHDAYBGBLUE + "' " + &
	             DATELABELMARK + String(ll_Cycle,"00") + "_t.Text = '" + ls_DayText + "' " + &
					 AREABKMARK    + String(ll_Cycle,"00") + "_t.Background.Color = '" + String(DARKBLUE) + "' " + &
					 AREABKMARK    + String(ll_Cycle,"00") + "_t.Tag = '" + String(ld_MonthDay) + "' "

	if idw_Disp_List[ll_Cycle].RowCount() > 0 then
		idw_Disp_List[ll_Cycle].Modify("DataWindow.Color = '" + String(DARKBLUE) + "' DataWindow.Detail.Color = '" + String(DARKBLUE) + "'")
		idw_Disp_List[ll_Cycle].Visible = true
	else
		idw_Disp_List[ll_Cycle].Visible = false
	end if
next

dw_Month_Calendar.Modify(ls_Modify)
//End Set the next month data

//Begin show or hide the Related objects
ls_Modify = ""

for ll_Cycle = 1 to ll_LastDispNum
	ls_Modify += BACKGDPICMARK + String(ll_Cycle,"00") + "_p.Visible = '1' " + &
	             DATELABELMARK + String(ll_Cycle,"00") + "_t.Visible = '1' " + &
	             AREABKMARK    + String(ll_Cycle,"00") + "_t.Visible = '1' "
next

for ll_Cycle = ll_LastDispNum + 1 to ROWCOUNT * COLCOUNT
	ls_Modify += BACKGDPICMARK + String(ll_Cycle,"00") + "_p.Visible = '0' " + &
	             DATELABELMARK + String(ll_Cycle,"00") + "_t.Visible = '0' " + &
	             AREABKMARK    + String(ll_Cycle,"00") + "_t.Visible = '0' "
	
	idw_Disp_List[ll_Cycle].Visible = false
	idw_Disp_List[ll_Cycle].Visible = false
next

dw_Month_Calendar.Modify(ls_Modify)
//End show or hide the Related objects

ll_PitchDay = Day(id_MonthCurrent)
if ll_PitchDay > ll_Days_In_Month then ll_PitchDay = ll_Days_In_Month
ls_PitchArea = AREABKMARK + String(ll_FirstDayWeekNo + ll_PitchDay - 1,"00") + "_t"

is_PreColColor = dw_Month_Calendar.Describe(is_PreColName + ".Background.Color")
of_PitchOnDate(ls_PitchArea)

of_ResetLayout()

dw_Month_Calendar.SetRedraw(TRUE)
This.SetRedraw(true)

end subroutine

public function long of_days_in_month (date ad_monthcurrent);//====================================================================
// Function: of_Days_In_Month()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    date    ad_MonthCurrent
//--------------------------------------------------------------------
// Returns:  long
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-10
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

long	ll_Year,ll_Month
long	ll_Days[12] = {31,28,31,30,31,30,31,31,30,31,30,31}

ll_Year  = Year(ad_MonthCurrent)
ll_Month = Month(ad_MonthCurrent)

if Mod(ll_Year,4) = 0 and Mod(ll_Year,100) <> 0 or Mod(ll_Year,400) = 0 then ll_Days[2] = 29

Return ll_Days[ll_Month]

end function

public function date of_get_next_month ();//====================================================================
// Function: of_Get_Next_Month()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  date
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-13
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

long	ll_Days
Date	ld_NextMonth

ll_Days = of_Days_In_Month(id_MonthFirst)
ld_NextMonth = RelativeDate(id_MonthFirst,ll_Days)

Return ld_NextMonth

end function

public function date of_get_prev_month ();//====================================================================
// Function: of_Get_Prev_Month()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  date
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-11-13
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

Date	ld_PreMonth

ld_PreMonth = RelativeDate(id_MonthFirst,-1)

Return ld_PreMonth

end function

public subroutine of_regresize ();This.of_SetResize(true)
This.inv_resize.of_SetDWZoom(false)

This.inv_Resize.of_Register(r_Frame,This.inv_Resize.SCALERIGHTBOTTOM)
This.inv_Resize.of_Register(dw_month_calendar,This.inv_Resize.SCALERIGHTBOTTOM)

end subroutine

public function date of_get_current_date ();//====================================================================
// Function: Of_Get_Current_Date()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
//--------------------------------------------------------------------
// Returns:  date
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2009-12-16
//--------------------------------------------------------------------
//	Copyright (c) 1999-2009 Contract Logix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

Return id_MonthCurrent

end function

public subroutine of_refreshfiltername (string as_filtername1, string as_filtername2, string as_filtername3);//====================================================================
// Function: of_refreshfiltername()
//--------------------------------------------------------------------
// Description:
//--------------------------------------------------------------------
// Arguments:
// 	value    string    as_filtername1
// 	value    string    as_filtername2
// 	value    string    as_filtername3
//--------------------------------------------------------------------
// Returns:  (None)
//--------------------------------------------------------------------
// Author:	Scofield		Date: 2010-03-16
//--------------------------------------------------------------------
//	Copyright (c) 1999-2010 ContractLogix, All rights reserved.
//--------------------------------------------------------------------
// Modify History:
//
//====================================================================

String	ls_Syntax

ls_Syntax = of_GetFilterNameSyntax(as_FilterName1,as_FilterName2,as_FilterName3)
			 
dw_Month_Calendar.Modify(ls_Syntax)

end subroutine

on u_calendar_month.create
int iCurrent
call super::create
this.dw_disp_list_42=create dw_disp_list_42
this.dw_disp_list_41=create dw_disp_list_41
this.dw_disp_list_40=create dw_disp_list_40
this.dw_disp_list_39=create dw_disp_list_39
this.dw_disp_list_38=create dw_disp_list_38
this.dw_disp_list_37=create dw_disp_list_37
this.dw_disp_list_36=create dw_disp_list_36
this.dw_disp_list_35=create dw_disp_list_35
this.dw_disp_list_34=create dw_disp_list_34
this.dw_disp_list_33=create dw_disp_list_33
this.dw_disp_list_32=create dw_disp_list_32
this.dw_disp_list_31=create dw_disp_list_31
this.dw_disp_list_30=create dw_disp_list_30
this.dw_disp_list_29=create dw_disp_list_29
this.dw_disp_list_25=create dw_disp_list_25
this.dw_disp_list_26=create dw_disp_list_26
this.dw_disp_list_27=create dw_disp_list_27
this.dw_disp_list_28=create dw_disp_list_28
this.dw_disp_list_21=create dw_disp_list_21
this.dw_disp_list_20=create dw_disp_list_20
this.dw_disp_list_19=create dw_disp_list_19
this.dw_disp_list_18=create dw_disp_list_18
this.dw_disp_list_17=create dw_disp_list_17
this.dw_disp_list_24=create dw_disp_list_24
this.dw_disp_list_23=create dw_disp_list_23
this.dw_disp_list_16=create dw_disp_list_16
this.dw_disp_list_22=create dw_disp_list_22
this.dw_disp_list_15=create dw_disp_list_15
this.dw_disp_list_14=create dw_disp_list_14
this.dw_disp_list_13=create dw_disp_list_13
this.dw_disp_list_12=create dw_disp_list_12
this.dw_disp_list_11=create dw_disp_list_11
this.dw_disp_list_10=create dw_disp_list_10
this.dw_disp_list_09=create dw_disp_list_09
this.dw_disp_list_08=create dw_disp_list_08
this.dw_disp_list_07=create dw_disp_list_07
this.dw_disp_list_06=create dw_disp_list_06
this.dw_disp_list_05=create dw_disp_list_05
this.dw_disp_list_04=create dw_disp_list_04
this.dw_disp_list_03=create dw_disp_list_03
this.dw_disp_list_02=create dw_disp_list_02
this.dw_disp_list_01=create dw_disp_list_01
this.r_frame=create r_frame
this.dw_month_calendar=create dw_month_calendar
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.dw_disp_list_42
this.Control[iCurrent+2]=this.dw_disp_list_41
this.Control[iCurrent+3]=this.dw_disp_list_40
this.Control[iCurrent+4]=this.dw_disp_list_39
this.Control[iCurrent+5]=this.dw_disp_list_38
this.Control[iCurrent+6]=this.dw_disp_list_37
this.Control[iCurrent+7]=this.dw_disp_list_36
this.Control[iCurrent+8]=this.dw_disp_list_35
this.Control[iCurrent+9]=this.dw_disp_list_34
this.Control[iCurrent+10]=this.dw_disp_list_33
this.Control[iCurrent+11]=this.dw_disp_list_32
this.Control[iCurrent+12]=this.dw_disp_list_31
this.Control[iCurrent+13]=this.dw_disp_list_30
this.Control[iCurrent+14]=this.dw_disp_list_29
this.Control[iCurrent+15]=this.dw_disp_list_25
this.Control[iCurrent+16]=this.dw_disp_list_26
this.Control[iCurrent+17]=this.dw_disp_list_27
this.Control[iCurrent+18]=this.dw_disp_list_28
this.Control[iCurrent+19]=this.dw_disp_list_21
this.Control[iCurrent+20]=this.dw_disp_list_20
this.Control[iCurrent+21]=this.dw_disp_list_19
this.Control[iCurrent+22]=this.dw_disp_list_18
this.Control[iCurrent+23]=this.dw_disp_list_17
this.Control[iCurrent+24]=this.dw_disp_list_24
this.Control[iCurrent+25]=this.dw_disp_list_23
this.Control[iCurrent+26]=this.dw_disp_list_16
this.Control[iCurrent+27]=this.dw_disp_list_22
this.Control[iCurrent+28]=this.dw_disp_list_15
this.Control[iCurrent+29]=this.dw_disp_list_14
this.Control[iCurrent+30]=this.dw_disp_list_13
this.Control[iCurrent+31]=this.dw_disp_list_12
this.Control[iCurrent+32]=this.dw_disp_list_11
this.Control[iCurrent+33]=this.dw_disp_list_10
this.Control[iCurrent+34]=this.dw_disp_list_09
this.Control[iCurrent+35]=this.dw_disp_list_08
this.Control[iCurrent+36]=this.dw_disp_list_07
this.Control[iCurrent+37]=this.dw_disp_list_06
this.Control[iCurrent+38]=this.dw_disp_list_05
this.Control[iCurrent+39]=this.dw_disp_list_04
this.Control[iCurrent+40]=this.dw_disp_list_03
this.Control[iCurrent+41]=this.dw_disp_list_02
this.Control[iCurrent+42]=this.dw_disp_list_01
this.Control[iCurrent+43]=this.r_frame
this.Control[iCurrent+44]=this.dw_month_calendar
end on

on u_calendar_month.destroy
call super::destroy
destroy(this.dw_disp_list_42)
destroy(this.dw_disp_list_41)
destroy(this.dw_disp_list_40)
destroy(this.dw_disp_list_39)
destroy(this.dw_disp_list_38)
destroy(this.dw_disp_list_37)
destroy(this.dw_disp_list_36)
destroy(this.dw_disp_list_35)
destroy(this.dw_disp_list_34)
destroy(this.dw_disp_list_33)
destroy(this.dw_disp_list_32)
destroy(this.dw_disp_list_31)
destroy(this.dw_disp_list_30)
destroy(this.dw_disp_list_29)
destroy(this.dw_disp_list_25)
destroy(this.dw_disp_list_26)
destroy(this.dw_disp_list_27)
destroy(this.dw_disp_list_28)
destroy(this.dw_disp_list_21)
destroy(this.dw_disp_list_20)
destroy(this.dw_disp_list_19)
destroy(this.dw_disp_list_18)
destroy(this.dw_disp_list_17)
destroy(this.dw_disp_list_24)
destroy(this.dw_disp_list_23)
destroy(this.dw_disp_list_16)
destroy(this.dw_disp_list_22)
destroy(this.dw_disp_list_15)
destroy(this.dw_disp_list_14)
destroy(this.dw_disp_list_13)
destroy(this.dw_disp_list_12)
destroy(this.dw_disp_list_11)
destroy(this.dw_disp_list_10)
destroy(this.dw_disp_list_09)
destroy(this.dw_disp_list_08)
destroy(this.dw_disp_list_07)
destroy(this.dw_disp_list_06)
destroy(this.dw_disp_list_05)
destroy(this.dw_disp_list_04)
destroy(this.dw_disp_list_03)
destroy(this.dw_disp_list_02)
destroy(this.dw_disp_list_01)
destroy(this.r_frame)
destroy(this.dw_month_calendar)
end on

event constructor;This.BackColor = LOWERBLUE

of_RegResize()

if Not IsValid(m_PopMonth) then
	m_PopMonth = Create m_Calendar_Month
	m_PopMonth.iu_Month = This
end if

end event

event destructor;call super::destructor;if IsValid(m_PopMonth) then Destroy m_PopMonth

end event

type dw_disp_list_42 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 3182
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 430
boolean border = false
end type

type dw_disp_list_41 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2674
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 420
boolean border = false
end type

type dw_disp_list_40 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2167
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 410
boolean border = false
end type

type dw_disp_list_39 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1659
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 400
boolean border = false
end type

type dw_disp_list_38 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1152
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 390
boolean border = false
end type

type dw_disp_list_37 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 645
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 380
boolean border = false
end type

type dw_disp_list_36 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 137
integer y = 2612
integer width = 293
integer height = 216
integer taborder = 370
boolean border = false
end type

type dw_disp_list_35 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 3182
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 360
boolean border = false
end type

type dw_disp_list_34 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2674
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 350
boolean border = false
end type

type dw_disp_list_33 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2167
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 340
boolean border = false
end type

type dw_disp_list_32 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1659
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 330
boolean border = false
end type

type dw_disp_list_31 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1152
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 320
boolean border = false
end type

type dw_disp_list_30 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 645
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 310
boolean border = false
borderstyle borderstyle = stylebox!
end type

type dw_disp_list_29 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 137
integer y = 2176
integer width = 293
integer height = 216
integer taborder = 300
boolean border = false
end type

type dw_disp_list_25 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1659
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 260
boolean border = false
end type

type dw_disp_list_26 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2167
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 270
boolean border = false
end type

type dw_disp_list_27 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2674
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 280
boolean border = false
end type

type dw_disp_list_28 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 3182
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 290
boolean border = false
end type

type dw_disp_list_21 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 3182
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 220
boolean border = false
end type

type dw_disp_list_20 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2674
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 210
boolean border = false
end type

type dw_disp_list_19 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2167
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 200
boolean border = false
end type

type dw_disp_list_18 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1659
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 190
boolean border = false
end type

type dw_disp_list_17 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1152
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 180
boolean border = false
end type

type dw_disp_list_24 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1152
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 250
boolean border = false
end type

type dw_disp_list_23 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 645
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 240
boolean border = false
end type

type dw_disp_list_16 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 645
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 170
boolean border = false
end type

type dw_disp_list_22 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 137
integer y = 1744
integer width = 293
integer height = 216
integer taborder = 230
boolean border = false
end type

type dw_disp_list_15 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 137
integer y = 1308
integer width = 293
integer height = 216
integer taborder = 160
boolean border = false
end type

type dw_disp_list_14 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 3182
integer y = 876
integer width = 293
integer height = 216
integer taborder = 150
boolean border = false
end type

type dw_disp_list_13 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2674
integer y = 876
integer width = 293
integer height = 216
integer taborder = 140
boolean border = false
end type

type dw_disp_list_12 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2167
integer y = 876
integer width = 293
integer height = 216
integer taborder = 130
boolean border = false
end type

type dw_disp_list_11 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1659
integer y = 876
integer width = 293
integer height = 216
integer taborder = 120
boolean border = false
end type

type dw_disp_list_10 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1152
integer y = 876
integer width = 293
integer height = 216
integer taborder = 110
boolean border = false
end type

type dw_disp_list_09 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 645
integer y = 876
integer width = 293
integer height = 216
integer taborder = 100
boolean border = false
end type

type dw_disp_list_08 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 137
integer y = 876
integer width = 293
integer height = 216
integer taborder = 90
boolean border = false
end type

type dw_disp_list_07 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 3182
integer y = 468
integer width = 293
integer height = 216
integer taborder = 80
boolean border = false
end type

type dw_disp_list_06 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2674
integer y = 468
integer width = 293
integer height = 216
integer taborder = 70
boolean border = false
end type

type dw_disp_list_05 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 2167
integer y = 468
integer width = 293
integer height = 216
integer taborder = 60
boolean border = false
end type

type dw_disp_list_04 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1659
integer y = 468
integer width = 293
integer height = 216
integer taborder = 50
boolean border = false
end type

type dw_disp_list_03 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 1152
integer y = 468
integer width = 293
integer height = 216
integer taborder = 40
boolean border = false
end type

type dw_disp_list_02 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 645
integer y = 468
integer width = 293
integer height = 216
integer taborder = 30
boolean border = false
end type

type dw_disp_list_01 from u_dw_calendar_item within u_calendar_month
boolean visible = false
integer x = 137
integer y = 468
integer width = 293
integer height = 216
integer taborder = 20
boolean border = false
end type

type r_frame from rectangle within u_calendar_month
long linecolor = 13603685
integer linethickness = 4
long fillcolor = 16765357
integer width = 3625
integer height = 2528
end type

type dw_month_calendar from datawindow within u_calendar_month
integer x = 5
integer y = 4
integer width = 3616
integer height = 2516
integer taborder = 10
string dataobject = "d_month_calendar"
boolean border = false
end type

event clicked;String	ls_ObjName
long		ll_Number

ls_ObjName = dwo.Name

if ls_ObjName = "p_leftarrow" then
	of_Goto_Prev_Month()
elseif ls_ObjName = "p_rightarrow" then
	of_Goto_Next_Month()
elseif ls_ObjName = "year_month_t" then
	m_PopMonth.PopMenu(w_Mdi.PointerX(),w_Mdi.PointerY())
elseif Pos(ls_ObjName,ACTIONITEMFILTERNAME) > 0 then
	ll_Number = long(Right(ls_ObjName,1))
	if ll_Number = 0 then
		Parent.GetParent().Dynamic of_GoToActionItemFilter()
	else
		Parent.GetParent().Dynamic of_SetActionItemQuickFilter(ll_Number)
	end if
elseif Pos(Lower(ls_ObjName),Lower(ARRANGEMODE)) > 0 then
	OpenWithParm(w_ArrangeMode,"")
	if Message.StringParm = "OK" then
		Parent.GetParent().Dynamic of_Refresh_Arrange()
		Parent.GetParent().Dynamic of_RefreshSelectScope(0)
	end if
elseif Pos(Lower(ls_ObjName),Lower(DATELABELMARK)) > 0 then
	of_PitchOnDate(AREABKMARK + Mid(ls_ObjName,Len(DATELABELMARK) + 1))
	Parent.GetParent().Dynamic of_RefreshSelectScope(1)
elseif Pos(Lower(ls_ObjName),Lower(AREABKMARK)) > 0 then
	of_PitchOnDate(ls_ObjName)
end if

end event

event rbuttondown;of_PitchOnDate(dwo.Name)

end event

event doubleclicked;This.Event Clicked(XPos,YPos,row,dwo)

end event

event resize;of_ResetLayout()

end event

